

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GPHGXML15W"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-GPHGXML15W');
    </script>
        <link href="_static/images/sepwc_logo.svg" rel="icon" type="image/svg+xml">
    <link href="https://raw.githubusercontent.com/jhill1/SEPwC/master/images/favicon-16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="https://raw.githubusercontent.com/jhill1/SEPwC/master/images/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/jhill1/SEPwC/master/images/favicon-180x180.png" sizes="180x180" type="image/png">
    <title>Mini course: ggplot2 tutorial &#8212; SEPwC  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'R_ggplot2';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mini course: Pyplot tutorial" href="python_plotting.html" />
    <link rel="prev" title="Testing code" href="Testing_code.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">SEPwC  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="How_a_computer_works.html">How a computer works</a></li>
<li class="toctree-l1"><a class="reference internal" href="Licences.html">Software licences</a></li>
<li class="toctree-l1"><a class="reference internal" href="Code_basics.html">The fundamentals of code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Thinking like a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python: the fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="R.html">R: the fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="Issues.html">Solving issues and debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Revision_control.html">Revision control with Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python2.html">Python: part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="R2.html">R: part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_development.html">Software development</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_first_coding_exercise.html">Our first coding exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python3.html">Python: part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="R3.html">R: part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spreadsheets_data.html">Moving from spreadsheets to data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing_code.html">Testing code</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mini course: ggplot2 tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_plotting.html">Mini course: Pyplot tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sentiment_analysis.html">Mini course: Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="tides_python.html">Mini course: Tidal analysis in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="GIS.html">Mini-course: GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/jhill1/SEPwC.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/R_ggplot2.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mini course: ggplot2 tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataset">The dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-basics">Plotting basics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#themes">Themes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axes">Axes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-limits-and-scales">Axes limits and scales</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-legends">Plot legends</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colours">Colours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-plots">Multiple plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#facets">Facets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-plot">Saving the plot</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="mini-course-ggplot2-tutorial">
<h1>Mini course: ggplot2 tutorial<a class="headerlink" href="#mini-course-ggplot2-tutorial" title="Permalink to this heading">#</a></h1>
<p id="index-0"><code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> is a popular library for creating pretty graphs and figures in R. It
works in a similar way to the tidyverse in terms of using dataframes as the basic data
and then adding layers on top to create the final plot.</p>
<p>This section is based on the tutorial by
<a class="reference external" href="https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/">Cedric Scherer</a></p>
<p><code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> is also used as a basis for other graphing packages, such as <code class="docutils literal notranslate"><span class="pre">ggpubr</span></code> which simplifies some
of the syntax here to create publication-level quality graphs. By learning <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> you should find
<code class="docutils literal notranslate"><span class="pre">ggpubr</span></code> very easy to use and have the knowledge to create more bespoke plots where needed.</p>
<section id="the-dataset">
<h2>The dataset<a class="headerlink" href="#the-dataset" title="Permalink to this heading">#</a></h2>
<p>We are using data from the National Morbidity and Mortality Air Pollution Study (NMMAPS).
To make the plots manageable we are limiting the data to Chicago and 1997–2000. For more detail
on this data set, consult Roger Peng’s book Statistical Methods in Environmental Epidemiology
with R. You can download the data we are using during this tutorial here (but you don’t have to).</p>
<p>We can import the data into our R session for example with <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> from the <code class="docutils literal notranslate"><span class="pre">{readr}</span></code> package.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">chic</span> <span class="o">&lt;-</span> <span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://cedricscherer.com/data/chicago-nmmaps-custom.csv&quot;</span><span class="p">)</span>
<span class="n">tibble</span><span class="o">::</span><span class="nf">glimpse</span><span class="p">(</span><span class="n">chic</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="plotting-basics">
<h2>Plotting basics<a class="headerlink" href="#plotting-basics" title="Permalink to this heading">#</a></h2>
<p>A ggplot is built up from a few basic elements:</p>
<ol class="arabic simple">
<li><p>Data: The raw data that you want to plot.</p></li>
<li><p>Geometries <code class="docutils literal notranslate"><span class="pre">geom_</span></code>: The geometric shapes that will represent the data.</p></li>
<li><p>Aesthetics <code class="docutils literal notranslate"><span class="pre">aes()</span></code>: Aesthetics of the geometric and statistical objects, such as position, color, size, shape, and transparency</p></li>
<li><p>Scales <code class="docutils literal notranslate"><span class="pre">scale_</span></code>: Maps between the data and the aesthetic dimensions, such as data range to plot width or factor values to colors.</p></li>
<li><p>Statistical transformations <code class="docutils literal notranslate"><span class="pre">stat_</span></code>: Statistical summaries of the data, such as quantiles, fitted curves, and sums.</p></li>
<li><p>Coordinate system <code class="docutils literal notranslate"><span class="pre">coord_</span></code>: The transformation used for mapping data coordinates into the plane of the data rectangle.</p></li>
<li><p>Facets <code class="docutils literal notranslate"><span class="pre">facet_</span></code>: The arrangement of the data into a grid of plots.</p></li>
<li><p>Visual themes <code class="docutils literal notranslate"><span class="pre">theme()</span></code>: The overall visual defaults of a plot, such as background, grids, axes, default typeface, sizes and colors.</p></li>
</ol>
<p>You need to specify the <code class="docutils literal notranslate"><span class="pre">data</span></code>, <code class="docutils literal notranslate"><span class="pre">geometry</span></code> and <code class="docutils literal notranslate"><span class="pre">aesthetics</span></code> as a minimum. To build up a ggplot we tell
ggplot the data, e.g. <code class="docutils literal notranslate"><span class="pre">ggplot(data</span> <span class="pre">=</span> <span class="pre">df)</span></code>. We then tell it which variables to plot i nthe aesthetics: <code class="docutils literal notranslate"><span class="pre">aes(x=var1,</span> <span class="pre">y=var2)</span></code>
and then we need to say what kind of plot via the geometry: <code class="docutils literal notranslate"><span class="pre">geom_point()</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span>
<span class="n">g</span> <span class="o">+</span> <span class="nf">geom_line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Note that we’ve stored the plot into an object, <code class="docutils literal notranslate"><span class="pre">g</span></code>. To display, we simply type <code class="docutils literal notranslate"><span class="pre">g</span></code> to the R console. However, here,
I’ve added  line geometry too. You can add other things to <code class="docutils literal notranslate"><span class="pre">g</span></code> on the fly:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
<p>(this will display immediately and does not affect the <code class="docutils literal notranslate"><span class="pre">g</span></code> object. Try plotting just <code class="docutils literal notranslate"><span class="pre">g</span> <span class="pre">+</span> <span class="pre">geom_line()</span></code> again).</p>
<p>You can maniuplate aspects of the geometry directly in the geometry function:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">&quot;diamond&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that ggplot2 understand <code class="docutils literal notranslate"><span class="pre">colour</span></code>, <code class="docutils literal notranslate"><span class="pre">color</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> and, of course, you can add more geometries:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="s">&quot;diamond&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="o">+</span>
    <span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">,</span> <span class="n">linetype</span> <span class="o">=</span> <span class="s">&quot;dotted&quot;</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="n">.</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="video_wrapper align-center" style="text-align: center">
<iframe allowfullscreen="true" src="https://www.youtube.com/embed/xh436DpK-pA" style="border: 0; height: 345px; width: 560px">
</iframe></div></section>
<section id="themes">
<h2>Themes<a class="headerlink" href="#themes" title="Permalink to this heading">#</a></h2>
<p id="index-1">Themes allow the setting up of axes, grids, fonts etc in a consistent way. <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> comes with a
number of built-in themes.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">theme_set</span><span class="p">(</span><span class="nf">theme_bw</span><span class="p">())</span>

<span class="n">g</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">theme_set</span></code> alters all plots in your current R session (or script). You can apply a theme to a
particular plot only too. Many aspects of the plot can be altered via the <code class="docutils literal notranslate"><span class="pre">theme()</span></code> function.
To see which details of a ggplot theme can be modified have a <a class="reference external" href="https://ggplot2.tidyverse.org/reference/theme.html">look here — and take some time; it’s a long list.</a></p>
</section>
<section id="axes">
<h2>Axes<a class="headerlink" href="#axes" title="Permalink to this heading">#</a></h2>
<p id="index-2">The default axes titles use the variable names. Let’s add some well-written labels to the axes.
For this, we add labs() providing a character string for each label we want to change (here x and y):</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id6" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note, we’re not saving the plot object into a variable and are instead instantly plotting it.</p>
<p><code class="docutils literal notranslate"><span class="pre">theme()</span></code> is an essential command to modify particular theme elements (texts and titles,
boxes, symbols, backgrounds, etc). We are going to use them a lot! For now, we are going to modify
text elements. We can change the properties of all or particular text elements (here axis titles)
by overwriting the default <code class="docutils literal notranslate"><span class="pre">element_text()</span></code> within the <code class="docutils literal notranslate"><span class="pre">theme()</span></code> call:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">theme</span><span class="p">(</span><span class="n">axis.title.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">vjust</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">15</span><span class="p">),</span>
             <span class="n">axis.title.y</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">vjust</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>We’ve adjusted the font size and the vertical positioning. Note that the <code class="docutils literal notranslate"><span class="pre">vjust</span></code> is the same of the positioning
of the horizontal axis; i.e. along the axis. There are a lot of things you can alter, but font size and positioning are
the crucial ones to know about.</p>
<p>The font axes text can also be altered:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">),</span>
             <span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">face</span> <span class="o">=</span> <span class="s">&quot;italic&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>This includes rotating the labels:</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id9" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>And removing ticks and text (not advised!):</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id10" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">theme</span><span class="p">(</span><span class="n">axis.ticks.y</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
             <span class="n">axis.text.y</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">element_blonk()</span></code> functions allows to remove any aspect of the theme, e.g. axes labels, if you wish.</p>
<section id="axes-limits-and-scales">
<h3>Axes limits and scales<a class="headerlink" href="#axes-limits-and-scales" title="Permalink to this heading">#</a></h3>
<p>A key part of producing attractive plots is the scale and limits of the axes. Using these you can ensure the
data are plotted correctly, e.g. on log-log axes or the key part of the data can be shown. You can, of course,
subset your data to do this, but you can also</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id11" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;firebrick&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">ylim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">50</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>There are other ways of limiting the plot using <code class="docutils literal notranslate"><span class="pre">scale_y_continuous(limits</span> <span class="pre">=</span> <span class="pre">c(0,50))</span></code> or
<code class="docutils literal notranslate"><span class="pre">coord_cartesian(ylim</span> <span class="pre">=</span> <span class="pre">c(0,50))</span></code>. These give similar results, but are, in fact, slightly different.
Try them both instead of the <code class="docutils literal notranslate"><span class="pre">ylim()</span></code>.</p>
<img alt="Graphs plotted using the ylim or scale (left) vs the coord_cartesian (right)." src="_images/axis-limit-comp-1.png" />
<p>Note the lack of buffer on the <code class="docutils literal notranslate"><span class="pre">coord_cartesian()</span></code> plot, compared to the <code class="docutils literal notranslate"><span class="pre">scale_y_continuous()</span></code> plot?
This is the difference between subsetting (<code class="docutils literal notranslate"><span class="pre">scale_y_continuous</span></code> and <code class="docutils literal notranslate"><span class="pre">ylim()</span></code>) and clipping (<code class="docutils literal notranslate"><span class="pre">coord_cartesian()</span></code>).
This is even more pronounced on a box-whisker plot:</p>
<img alt="Boxplots plotted using the ylim or scale (left) vs the coord_cartesian (right)." src="_images/axis-limit-comp-box-1.png" />
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Notice the median lines are different here! If you scale or impose <code class="docutils literal notranslate"><span class="pre">ylim</span></code> it is worth checking your data without
limits first! In other word, build up your plot carefully and also run the stats within R, not just rely on reading
the graphs…</p>
</div>
<p>You can force R to plot starting from some coordinates, e.g. the (0,0) origin:</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id12" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chic_high</span> <span class="o">&lt;-</span> <span class="n">dplyr</span><span class="p">::</span><span class="nb">filter</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">,</span> <span class="n">o3</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">chic_high</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">o3</span><span class="p">))</span> <span class="o">+</span>
       <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkcyan&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Temperature higher than 25°F&quot;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Ozone higher than 20 ppb&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">expand_limits</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>But we can also force it to literally start at the origin!</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id13" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">chic_high</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">o3</span><span class="p">))</span> <span class="o">+</span>
       <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkcyan&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Temperature higher than 25°F&quot;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Ozone higher than 20 ppb&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">expand_limits</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">coord_cartesian</span><span class="p">(</span><span class="n">expand</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">clip</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The argument clip = “off” in any coordinate system (<code class="docutils literal notranslate"><span class="pre">coord_*</span></code>), allows to draw outside of the panel area.</p>
</div>
<p>Scaling is an important part of plotting. If you are expecting a 1:1 ratio between your variables, creating
a plot with the axes scaled to that helps visualisation. For demonstrating purposes, let’s plot temperature
against temperature with some random noise. The <code class="docutils literal notranslate"><span class="pre">coord_equal(</span></code>) is a coordinate system with a specified ratio
representing the number of units on the y-axis equivalent to one unit on the x-axis. The default, ratio = 1,
ensures that one unit on the x-axis is the same length as one unit on the y-axis:</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id14" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="nf">rnorm</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">chic</span><span class="p">),</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">20</span><span class="p">)))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;sienna&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F) + random noise&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="nf">xlim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">100</span><span class="p">))</span> <span class="o">+</span> <span class="nf">ylim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">150</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">coord_fixed</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Ratios larger than 1 make the units on the y-axis long than those on the x, and
vice-versa:</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id15" title="Permalink to this code">#</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="n">rnorm</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">chic</span><span class="p">),</span> <span class="n">sd</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)))</span> <span class="o">+</span>
       <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;sienna&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Temperature (°F)&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Temperature (°F) + random noise&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">xlim</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="n">ylim</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">))</span> <span class="o">+</span>
       <span class="n">coord_fixed</span><span class="p">(</span><span class="n">ratio</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="plot-legends">
<h2>Plot legends<a class="headerlink" href="#plot-legends" title="Permalink to this heading">#</a></h2>
<p id="index-3">We often colour code parts of our graphs, and then add a legend to show how the data are separated.
We will <code class="docutils literal notranslate"><span class="pre">color</span></code> code the plot based on season. Or to phrase it in a more <code class="docutils literal notranslate"><span class="pre">ggplot</span></code>’ish way: we map the
variable season to the aesthetic <code class="docutils literal notranslate"><span class="pre">color</span></code>. One nice thing about <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> is that it adds a legend by
default when mapping a variable to an aesthetic. You can see that by default the legend title is
what we specified in the <code class="docutils literal notranslate"><span class="pre">color</span></code> argument:</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id16" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>How can you remove the legend if it is added by default?</p>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id17" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">guides(color</span> <span class="pre">=</span> <span class="pre">&quot;none&quot;)</span></code> or <code class="docutils literal notranslate"><span class="pre">scale_color_discrete(guide</span> <span class="pre">=</span> <span class="pre">&quot;none&quot;)</span></code> depending on
the specific case. While the change of the theme element removes all legends at once,
you can remove particular legends with the latter options while keeping some others:</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id18" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span>
       <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">guides</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here, we’ve kept the legend for the shape, but not colour. Note that the aesthetics is where
we map shape and colour. If we do it outside the aesthetic we don’t get a legend for that property.</p>
<p>We can remove titles for legend using the <code class="docutils literal notranslate"><span class="pre">element_blank()</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id19" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.title</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>And also chnage the position:</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id20" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;top&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The possible options are <code class="docutils literal notranslate"><span class="pre">top</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code> and <code class="docutils literal notranslate"><span class="pre">bottom</span></code>. You can also specify
a coordinate for the legend to be from 0 to 1 (0 is the left/bottom, 1 is the right/top):</p>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id21" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span>
     <span class="n">color</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">15</span><span class="p">,</span> <span class="n">.</span><span class="m">15</span><span class="p">),</span>
      <span class="n">legend.background</span> <span class="o">=</span> <span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;transparent&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The legend also has a transparent background here to make sure no points are hidden. You can also switch the
direction:</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id22" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">5</span><span class="p">,</span> <span class="n">.</span><span class="m">97</span><span class="p">),</span>
      <span class="n">legend.background</span> <span class="o">=</span> <span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;transparent&quot;</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">guides</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="nf">guide_legend</span><span class="p">(</span><span class="n">direction</span> <span class="o">=</span> <span class="s">&quot;horizontal&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>The default title is dictated by the variable name, just as the axes. To change it
to something more readable use the <code class="docutils literal notranslate"><span class="pre">labs()</span></code> function:</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id23" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span>
     <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;Seasons\nindicated\nby colors:&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You will probably want to alter the order in which the legend elements appear, e.g. for
seasons, putting them in order makes sense. We can’t that in <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> and instead we
have to alter the variable in the dataframe itself. We alter the <code class="docutils literal notranslate"><span class="pre">levels</span></code> in the <code class="docutils literal notranslate"><span class="pre">season</span></code>
column:</p>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id24" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">chic</span><span class="o">$</span><span class="n">season</span> <span class="o">&lt;-</span>
    <span class="nf">factor</span><span class="p">(</span><span class="n">chic</span><span class="o">$</span><span class="n">season</span><span class="p">,</span>
           <span class="n">levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Winter&quot;</span><span class="p">,</span> <span class="s">&quot;Spring&quot;</span><span class="p">,</span> <span class="s">&quot;Summer&quot;</span><span class="p">,</span> <span class="s">&quot;Autumn&quot;</span><span class="p">))</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can alter the labels though easily in <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id25" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">scale_color_discrete</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Seasons:&quot;</span><span class="p">,</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;Mar—May&quot;</span><span class="p">,</span> <span class="s">&quot;Jun—Aug&quot;</span><span class="p">,</span> <span class="s">&quot;Sep—Nov&quot;</span><span class="p">,</span> <span class="s">&quot;Dec—Feb&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you add multiple geometries you will find the legend has them all on too, for example:</p>
<div class="literal-block-wrapper docutils container" id="id26">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id26" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">geom_rug</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Note the line in the legend symbols? This comes from the <code class="docutils literal notranslate"><span class="pre">geom_rug()</span></code>. To turn it off
you add the <code class="docutils literal notranslate"><span class="pre">show.legend</span> <span class="pre">=</span> <span class="pre">FALSE</span></code> to the <code class="docutils literal notranslate"><span class="pre">geom_*()</span></code> call:</p>
<div class="literal-block-wrapper docutils container" id="id27">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id27" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">geom_rug</span><span class="p">(</span><span class="n">show.legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The examples above are for discrete or categorical data. <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> also shows legends
for continuous data, such as the temperature:</p>
<div class="literal-block-wrapper docutils container" id="id28">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id28" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
       <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It is possible to force discrete legends or binned legends too.</p>
<section id="colours">
<h3>Colours<a class="headerlink" href="#colours" title="Permalink to this heading">#</a></h3>
<p id="index-4">A key part of the plot is the colour scheme chosen. There are two main
colour elements to alter; <code class="docutils literal notranslate"><span class="pre">color</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code>. These can be either a single colour
or assigned to a variable. For a specified colour add the colour to the <code class="docutils literal notranslate"><span class="pre">geometry()</span></code>
function:</p>
<div class="literal-block-wrapper docutils container" id="id29">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id29" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">21</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">stroke</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
           <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;#3cc08f&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;#c08f3c&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Here, I’ve specifed the <code class="docutils literal notranslate"><span class="pre">color</span></code> and the <code class="docutils literal notranslate"><span class="pre">fill</span></code>. The <code class="docutils literal notranslate"><span class="pre">color</span></code> is
used as an outline, where the <code class="docutils literal notranslate"><span class="pre">fill</span></code> is used in the centre of the shape.
Note I’ve also had to specify a stroke (the outline) to show the this. Also note
I’ve specified colours using hexidecimal codes. These are the R(ed) G(reen) B(lue)
components in values of 0 to 255 in hexidecimal. There are lot of webpages
to find the hex codes of colours around.</p>
<p>You can also asign a palatte to a colour. This is obviously most useful when assign
colour to a variable. You can alter these using the <code class="docutils literal notranslate"><span class="pre">scale_color_*</span></code> and <code class="docutils literal notranslate"><span class="pre">scale_fill_*</span></code>
functions. You can also manually create a palette.</p>
<div class="literal-block-wrapper docutils container" id="id30">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id30" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ga</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">season</span><span class="p">))</span> <span class="o">+</span>
       <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
       <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>We’ve created a <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> object, <code class="docutils literal notranslate"><span class="pre">ga</span></code> with the default palette. Now lets
alter this:</p>
<div class="literal-block-wrapper docutils container" id="id31">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id31" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">ga</span> <span class="o">+</span> <span class="nf">scale_color_brewer</span><span class="p">(</span><span class="n">palette</span> <span class="o">=</span> <span class="s">&quot;Set1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To use the <code class="docutils literal notranslate"><span class="pre">Set1</span></code> scheme from R Color Brewer. If we wanted to set our own colours:</p>
<div class="literal-block-wrapper docutils container" id="id32">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id32" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">ga</span> <span class="o">+</span> <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;dodgerblue4&quot;</span><span class="p">,</span>
                                   <span class="s">&quot;darkolivegreen4&quot;</span><span class="p">,</span>
                                   <span class="s">&quot;darkorchid3&quot;</span><span class="p">,</span>
                                   <span class="s">&quot;goldenrod1&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>For continuous variables we need the <code class="docutils literal notranslate"><span class="pre">scale_*_gradient()</span></code> or <code class="docutils literal notranslate"><span class="pre">scale_*_continuous()</span></code>
functions:</p>
<div class="literal-block-wrapper docutils container" id="id33">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id33" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">gb</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
             <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
             <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F):&quot;</span><span class="p">)</span>

<span class="n">gb</span> <span class="o">+</span> <span class="nf">scale_color_continuous</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>We can use a diverging colour scheme:</p>
<div class="literal-block-wrapper docutils container" id="id34">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id34" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">mid</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">chic</span><span class="o">$</span><span class="n">temp</span><span class="p">)</span>  <span class="c1">## midpoint</span>
<span class="n">gb</span> <span class="o">+</span> <span class="nf">scale_color_gradient2</span><span class="p">(</span><span class="n">midpoint</span> <span class="o">=</span> <span class="n">mid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>It is possible to specify your own colour palette, but I would recommend sticking to
pre-defined ones, especially the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> set, which are colour-blind safe.</p>
</section>
</section>
<section id="multiple-plots">
<h2>Multiple plots<a class="headerlink" href="#multiple-plots" title="Permalink to this heading">#</a></h2>
<p id="index-5">In the last code I snuck in an example of adding multiple plots to a figure!
There are two main ways to do this: using the built-in <code class="docutils literal notranslate"><span class="pre">facet</span></code> or using an external
package, such as <code class="docutils literal notranslate"><span class="pre">patchwork</span></code>.</p>
<section id="facets">
<h3>Facets<a class="headerlink" href="#facets" title="Permalink to this heading">#</a></h3>
<p>Facets act on a variable in your data so are an easy way to separate out components.
There are two ways to do this using either <code class="docutils literal notranslate"><span class="pre">facet_grid</span></code> or <code class="docutils literal notranslate"><span class="pre">facet_wrap</span></code>. The first
can produce a grid based on one or two variables. The latter produces a “ribbon” of plots.</p>
<div class="literal-block-wrapper docutils container" id="id35">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id35" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">.</span><span class="m">3</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
<span class="nf">facet_grid</span><span class="p">(</span><span class="n">year</span> <span class="o">~</span> <span class="n">season</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Try the above with <code class="docutils literal notranslate"><span class="pre">facet_grid(season</span> <span class="pre">~</span> <span class="pre">year)</span></code> too. The <code class="docutils literal notranslate"><span class="pre">facet_wrap</span></code> produces something similar:</p>
<div class="literal-block-wrapper docutils container" id="id36">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id36" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span><span class="p">))</span> <span class="o">+</span>
     <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;chartreuse4&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">.</span><span class="m">3</span><span class="p">)</span> <span class="o">+</span>
     <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&quot;Year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span> <span class="o">+</span>
     <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">))</span>

<span class="n">g</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span> <span class="n">year</span><span class="p">,</span> <span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There are a number of other options to tailor the plot just to your liking. In the above
example, the wrap uses the same axis (this is generally what you would want!), but here, we don’t.
We can alter using the <code class="docutils literal notranslate"><span class="pre">scales</span> <span class="pre">=</span> <span class="pre">&quot;free&quot;</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id37">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id37" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span> <span class="n">year</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&quot;free&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If we use two variables with <code class="docutils literal notranslate"><span class="pre">facet_wrap</span></code> we can a slightly different view:</p>
<div class="literal-block-wrapper docutils container" id="id38">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id38" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="n">year</span> <span class="o">~</span> <span class="n">season</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&quot;free_x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="saving-the-plot">
<h2>Saving the plot<a class="headerlink" href="#saving-the-plot" title="Permalink to this heading">#</a></h2>
<p id="index-6">Assuming you have saved your plot into an object you can save the plot to a file using
the <code class="docutils literal notranslate"><span class="pre">ggsave()</span></code> function:</p>
<div class="literal-block-wrapper docutils container" id="id39">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id39" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;output_filename.pdf&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">final_plot</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">297</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="m">210</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;mm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This saves an A4 PDF of the <code class="docutils literal notranslate"><span class="pre">final_plot</span></code> object. Look up the <code class="docutils literal notranslate"><span class="pre">ggsave</span></code> function for more options.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">patchwork</span></code> (or <code class="docutils literal notranslate"><span class="pre">ggarange</span></code> or any other package to place multiple plots together) that
object is the output of the <code class="docutils literal notranslate"><span class="pre">patchwork</span></code> call:</p>
<div class="literal-block-wrapper docutils container" id="id40">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id40" title="Permalink to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">final_plot</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">+</span> <span class="n">p3</span> <span class="o">+</span> <span class="n">p4</span><span class="p">)</span> <span class="o">*</span> <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&quot;bottom&quot;</span><span class="p">)</span>
<span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;output_filename.pdf&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">final_plot</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">297</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="m">210</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;mm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Testing_code.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Testing code</p>
      </div>
    </a>
    <a class="right-next"
       href="python_plotting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mini course: Pyplot tutorial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataset">The dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-basics">Plotting basics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#themes">Themes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#axes">Axes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-limits-and-scales">Axes limits and scales</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-legends">Plot legends</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#colours">Colours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-plots">Multiple plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#facets">Facets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-plot">Saving the plot</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jon Hill
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jon Hill.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>