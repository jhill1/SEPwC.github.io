
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GPHGXML15W"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-GPHGXML15W');
    </script>
        <link href="_static/images/sepwc_logo.svg" rel="icon" type="image/svg+xml">
    <link href="https://raw.githubusercontent.com/jhill1/SEPwC/master/images/favicon-16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="https://raw.githubusercontent.com/jhill1/SEPwC/master/images/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/jhill1/SEPwC/master/images/favicon-180x180.png" sizes="180x180" type="image/png">
    <title>Mini-course: GIS &#8212; SEPwC  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'GIS';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="genindex.html" />
    <link rel="prev" title="Mini course: Tidal analysis in Python" href="tides_python.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">SEPwC  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="How_a_computer_works.html">How a computer works</a></li>
<li class="toctree-l1"><a class="reference internal" href="Licences.html">Software licences</a></li>
<li class="toctree-l1"><a class="reference internal" href="Code_basics.html">The fundamentals of code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Thinking like a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python: the fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="R.html">R: the fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="Issues.html">Solving issues and debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Revision_control.html">Revision control with Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python2.html">Python: part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="R2.html">R: part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="github.html">Using git with Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_development.html">Software development</a></li>
<li class="toctree-l1"><a class="reference internal" href="a_first_coding_exercise.html">Our first coding exercise</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python3.html">Python: part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="R3.html">R: part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spreadsheets_data.html">Moving from spreadsheets to data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing_code.html">Testing code</a></li>
<li class="toctree-l1"><a class="reference internal" href="R_ggplot2.html">Mini course: ggplot2 tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_plotting.html">Mini course: Pyplot tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sentiment_analysis.html">Mini course: Sentiment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="tides_python.html">Mini course: Tidal analysis in Python</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mini-course: GIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/jhill1/SEPwC.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/GIS.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mini-course: GIS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis">GIS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-data">Vector data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raster-data">Raster data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-references-system">Coordinate References System</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-r">GIS - R</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-terra-library">The <code class="docutils literal notranslate"><span class="pre">terra</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-sf-library">The <code class="docutils literal notranslate"><span class="pre">sf</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#switching-between-the-two">Switching between the two</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-python">GIS - Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-rasterio-library">The <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-geopandas-library">The <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-shapely-library">The <code class="docutils literal notranslate"><span class="pre">shapely</span></code> library</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="mini-course-gis">
<h1>Mini-course: GIS<a class="headerlink" href="#mini-course-gis" title="Link to this heading">#</a></h1>
<section id="gis">
<span id="index-0"></span><h2>GIS<a class="headerlink" href="#gis" title="Link to this heading">#</a></h2>
<p>This is a brief introduction to geospatial data which applied to both Python
and R. Geospatial data is information that also has a geographical component.
Example include house proces, coupled to locations; roads and road types or hazard
assessment.</p>
<p>There are three things we need to learn about first:</p>
<blockquote>
<div><ul class="simple">
<li><p>vector data</p></li>
<li><p>raster data</p></li>
<li><p>projection spaces or coordinate spaces</p></li>
</ul>
</div></blockquote>
<section id="vector-data">
<h3>Vector data<a class="headerlink" href="#vector-data" title="Link to this heading">#</a></h3>
<p id="index-1">Vector data represent geometries via mathematicla objects. You can zoom
into a vector infinitely at it will remain infintely small! There are
three types of vector data:</p>
<blockquote>
<div><ul class="simple">
<li><p>points</p></li>
<li><p>lines</p></li>
<li><p>polygons</p></li>
</ul>
</div></blockquote>
<p>Vectors are most commonly stored as shapefiles: <code class="docutils literal notranslate"><span class="pre">*.shp</span></code> files. We call then shapefiles
put they actually consist of a number of files. So a file called <code class="docutils literal notranslate"><span class="pre">landslides.shp</span></code> also
will have <code class="docutils literal notranslate"><span class="pre">landslides.prj</span></code>, <code class="docutils literal notranslate"><span class="pre">landslides.dbf</span></code> and <code class="docutils literal notranslate"><span class="pre">landslides.shx</span></code> and a few more beside.
All files are required to fully define the shapefile.</p>
<p>Shapefiles often contain data alongside the vector representation. So for example, the shape
of buildings might be contained in the shapefile, but the polygons with the outline of the building
footprint might also contains the address, the price, the date built, etc.</p>
</section>
<section id="raster-data">
<h3>Raster data<a class="headerlink" href="#raster-data" title="Link to this heading">#</a></h3>
<p id="index-2">Raster data are a grid of pixels of a resolution. Each pixel has a value, such as height
temperature, land use category, etc. The data are stored in <em>bands</em>, so a raster can contain
multiple datasets within the same structure and file. It’s common for colour
images, such as satellite images, to be stored in a R(ed), G(reeen), and B(lue) bands.</p>
<p>The image below shows the difference between how data is stored in both raster
and vector formats; either can be used, but raster data have a “resolution” issue where
the size of the grid alters the accuracy of the data. However, raster data can store a
lot of data very efficiently, e.g. land hieght data where you need continuous measurements.</p>
<figure class="align-default" id="id3">
<img alt="Difference between raster and vector images." src="_images/raster_vector_gis.png" />
<figcaption>
<p><span class="caption-text">Raster vs Vector for a land-use type dataset. From <a class="reference external" href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a> by <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Joey-das-WBF">Johannes Rössel</a> (CC-BY-SA licence)</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="coordinate-references-system">
<h3>Coordinate References System<a class="headerlink" href="#coordinate-references-system" title="Link to this heading">#</a></h3>
<p id="index-3">GIS is a 2D system. But the Earth is 3D; almost a sphere in fact. To display the
3D surface to a 2D screen you need to project into a 2D space; the Coordinate References System
(CRS). Any  CRS required trade offs. You can preserve area or shape or distance, but not all three!
Compare the two projections of the Earth below; the Mollweide preserves areas, so the size of Greenland
to Africa is shown to scale, but you could not navigate using this map; your bearings
would be very wrong! The Mercator projection preserves angles; excellent for navigation, but
not so good for comparing areas. Greenland (2.1 million km<sup>2</sup>) is not bigger than the whole of Africa
(30.1 million km<sup>2</sup>)!</p>
<p>In R and Python if you are doing operations on geospatial data they <strong>must</strong> be in the
same projection space. Your operation may work, but you won’t get the result you want!</p>
<p>Common projection spaces are “mercator” and “Universal Tranverse Mercator (UTM)”. For
“regional” studies UTM is best. It’s in metres (not degrees!) and covers a reasonably
large area with little deformation.</p>
<figure class="align-default" id="id4">
<img alt="A global Mollweide projection which preserves area." src="_images/Mollweide_projection_SW.jpg" />
<figcaption>
<p><span class="caption-text">Mollweide projection of the Earth, preserving areas. From <a class="reference external" href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a> by <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Strebe">Daniel R. Strebe</a> (CC-BY-SA licence)</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id5">
<img alt="A global Mercator projection which preserves angles." src="_images/Mercator_projection_Square.JPG" />
<figcaption>
<p><span class="caption-text">Mercator projection of the Earth, preserving angles. From <a class="reference external" href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a> by <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Strebe">Daniel R. Strebe</a> (CC-BY-SA licence)</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="gis-r">
<h2>GIS - R<a class="headerlink" href="#gis-r" title="Link to this heading">#</a></h2>
<p id="index-4">R has a number of packages that can help with GIS analysis. We’re going to focus on
two: <code class="docutils literal notranslate"><span class="pre">terra</span></code> and <code class="docutils literal notranslate"><span class="pre">sf</span></code>. For most tasks <code class="docutils literal notranslate"><span class="pre">terra</span></code> might be enough as it can handle
vector and raster data. <code class="docutils literal notranslate"><span class="pre">sf</span></code> focusses on vector data only.</p>
<p>You should download this <a class="reference external" href="https://github.com/jhill1/SEPwC/raw/master/code_examples/gis_data.zip">zip file</a>
which contains the data required. Make sure you
change your working directory to match where you’ve downloaded the data.</p>
<section id="the-terra-library">
<h3>The <code class="docutils literal notranslate"><span class="pre">terra</span></code> library<a class="headerlink" href="#the-terra-library" title="Link to this heading">#</a></h3>
<p id="index-5">The <code class="docutils literal notranslate"><span class="pre">terra</span></code> library is based around two key classes: <code class="docutils literal notranslate"><span class="pre">SpatRatser</span></code> and <code class="docutils literal notranslate"><span class="pre">SpatVector</span></code>.
Let’s look at rasters first.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id6" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">my_raster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rast</span><span class="p">(</span><span class="s">&quot;tidal_range.tif&quot;</span><span class="p">)</span>
<span class="n">my_raster</span>
</pre></div>
</div>
</div>
<p>R will print out some basic info on the raster. This includes the extent, the projection
space and min and max values.</p>
<p>You can summarise the raster too:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id7" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">my_raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For this raster dataset, there is a single band. Rasters can store multiple
bands in a single file. It’s common, for example, to store the R, G and B
colours separately. You can check this using the <code class="docutils literal notranslate"><span class="pre">nlyr</span></code> function:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id8" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">nlyr</span><span class="p">(</span><span class="n">my_raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Raster data can contain missing data, held in the <code class="docutils literal notranslate"><span class="pre">NoDataValue</span></code> property of
the raster. This value tells any reader to ignore this cell. When loading in R,
these values will be assigned as <code class="docutils literal notranslate"><span class="pre">NA</span></code> in the variable where you load the raster.
The actual value could be anything, but common values include <code class="docutils literal notranslate"><span class="pre">-9999</span></code> and <code class="docutils literal notranslate"><span class="pre">-3.4e+38</span></code>.
When plotting in R, those <code class="docutils literal notranslate"><span class="pre">NA</span></code> will be transparent, but you can choose another
colour.</p>
<p>The data in the raster contains the Coordinate Reference System (CRS) otherwise
known as the projection space. This tells you where that raster is located
and what the coordinates mean (metres, degrees, etc). You can also change that
projection space using the <code class="docutils literal notranslate"><span class="pre">project()</span></code> function. When you project onto another
CRS you will change your data. By default the projection will use
bilinear interpolation to generate the data at the new coordinates. You can
change this to cubic, or cubicspline or use another algorithm. Stick with
bilinear unless you have a reason to change this.</p>
<div class="admonition-thought-exercise admonition">
<p class="admonition-title">Thought exercise</p>
<p>Have a search using a popular search engine to see if you can figure out
why bilinear interpolation is default.</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<p>Bilinear interpolation will not add any new values to the new data. The
new data maximum value will be equal to, or slightly less, than the old data;
and likewise, the minimum will be the same or slightly greater. Cubic or cubicspline
can <em>overshoot</em> the limits of the old data, but can also produce smoother data,
without abrupt changes. Whenever you project onto a new coordinate system you
are altering the data.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id9" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">raster_in_latlon</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">project</span><span class="p">(</span><span class="n">my_raster</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;+init=EPSG:4326&quot;</span><span class="p">)</span>
<span class="nf">crs</span><span class="p">(</span><span class="n">raster_in_latlon</span><span class="p">)</span>
<span class="nf">ext</span><span class="p">(</span><span class="n">raster_in_latlon</span><span class="p">)</span>
<span class="nf">crs</span><span class="p">(</span><span class="n">my_raster</span><span class="p">)</span>
<span class="nf">ext</span><span class="p">(</span><span class="n">my_raster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The raster is transformed from the original project space (UTM 31N) to a lat/lon
projection space: WGS84. I’ve also thrown in the <code class="docutils literal notranslate"><span class="pre">ext()</span></code> function which gives
you the extent of the raster in the coordinate space.</p>
<p>When dealing with raster data you often need the rasters to be identical;
same resolution, same extents, same projection space. Once identical, then
simple calculations (and indeed more complex ones!) can be carried out.</p>
<p>To write any raster to file, use the <code class="docutils literal notranslate"><span class="pre">writeRaster</span></code> function:</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id10" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">writeRaster</span><span class="p">(</span><span class="n">raster_in_latlon</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UK_tidal_range.tiff&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">filetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;GTiff&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">overwrite</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">            </span><span class="n">NAflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-9999</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Hopefully, the options used here are obvious! Use the overwrite option with caution!
<code class="docutils literal notranslate"><span class="pre">terra</span></code> comes with a number of useful functions, including those to calculate
slope, proximity distance, extract data from rasters, create a stack of rasters,
and to <em>rasterise</em> a vector (i.e. convert from vector to
raster).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">terra</span></code> library can also load vector data:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id11" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">tidal_gauges</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vect</span><span class="p">(</span><span class="s">&quot;tide_gauges.shp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The same functions as above (<code class="docutils literal notranslate"><span class="pre">crs()</span></code>, <code class="docutils literal notranslate"><span class="pre">ext()</span></code>, <code class="docutils literal notranslate"><span class="pre">project()</span></code>) work as expected on
vector data.</p>
<div class="video_wrapper align-center" style="text-align: center">
<iframe allowfullscreen="true" src="https://www.youtube.com/embed/bzD-DGFcxUw" style="border: 0; height: 345px; width: 560px">
</iframe></div></section>
<section id="the-sf-library">
<h3>The <code class="docutils literal notranslate"><span class="pre">sf</span></code> library<a class="headerlink" href="#the-sf-library" title="Link to this heading">#</a></h3>
<p id="index-6">R also have another popular library for dealing with shapefiles/vector data; <code class="docutils literal notranslate"><span class="pre">sf</span></code>.
This library has more features than <code class="docutils literal notranslate"><span class="pre">terra</span></code> so is worth learning.</p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id12" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
<span class="n">tide_gauges</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">st_read</span><span class="p">(</span><span class="s">&quot;tide_gauges.shp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Vector data can be points, lines or polygons. We can find out which using:</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id13" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">st_geometry_type</span><span class="p">(</span><span class="n">tide_gauges</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can then find out the CRS and extennt:</p>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id14" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">st_crs</span><span class="p">(</span><span class="n">tide_gauges</span><span class="p">)</span>
<span class="nf">st_bbox</span><span class="p">(</span><span class="n">tide_gauges</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">sf</span></code> to create a shapefile on the fly:</p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id15" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">aoi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.polygons</span><span class="p">(</span><span class="n">terra</span><span class="o">::</span><span class="nf">ext</span><span class="p">(</span><span class="n">my_raster</span><span class="p">),</span><span class="w"> </span><span class="n">crs</span><span class="o">=</span><span class="n">terra</span><span class="o">::</span><span class="nf">crs</span><span class="p">(</span><span class="n">my_raster</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Here, I’ve created a polygon with the extent from a raster (loaded via <code class="docutils literal notranslate"><span class="pre">terra</span></code>)
and the same CRS as that raster. I’ve explicitly flagged the use of <code class="docutils literal notranslate"><span class="pre">terra</span></code> functions
here to make it clear where my extents came from.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sf</span></code> library has a number of functions not available in <code class="docutils literal notranslate"><span class="pre">terra</span></code>, such as
sampling within a polygon, geometry calculations (differences, unions, intersections),
and geometric calculations (area, distances, lengths).</p>
</section>
<section id="switching-between-the-two">
<h3>Switching between the two<a class="headerlink" href="#switching-between-the-two" title="Link to this heading">#</a></h3>
<p>Using two different libraries for shapefiles can be a pain, but it is fairly
easy to switch a vector dataset between the two.</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id16" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">sf</span><span class="o">::</span><span class="nf">st_as_sf</span><span class="p">(</span><span class="n">terra</span><span class="o">::</span><span class="nf">vect</span><span class="p">(</span><span class="s">&quot;tide_gauges.shp&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Will convert a <code class="docutils literal notranslate"><span class="pre">terra</span></code> vector to the <code class="docutils literal notranslate"><span class="pre">sf</span></code> format. Normally, <code class="docutils literal notranslate"><span class="pre">terra</span></code> can deal with
<code class="docutils literal notranslate"><span class="pre">sf</span></code> objects, but you sometimes need to wrap the <code class="docutils literal notranslate"><span class="pre">sf</span></code> object in the <code class="docutils literal notranslate"><span class="pre">st_zm</span></code> function:</p>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/R_logo.png"><img alt="R" src="_images/R_logo.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id17" title="Link to this code">#</a></div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">points_as_raster</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rasterize</span><span class="p">(</span><span class="nf">st_zm</span><span class="p">(</span><span class="n">tide_gauges</span><span class="p">),</span><span class="w"> </span><span class="n">my_raster</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">st_zm</span></code> function removes all <code class="docutils literal notranslate"><span class="pre">z</span></code> and <code class="docutils literal notranslate"><span class="pre">m</span></code> data which makes the object
compatible with <code class="docutils literal notranslate"><span class="pre">terra</span></code>.</p>
</section>
</section>
<section id="gis-python">
<h2>GIS - Python<a class="headerlink" href="#gis-python" title="Link to this heading">#</a></h2>
<p id="index-7">Python has a number of packages that can help with GIS analysis. We’re going to focus on
three: <code class="docutils literal notranslate"><span class="pre">rasterio</span></code>, <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> and <code class="docutils literal notranslate"><span class="pre">shapely</span></code>.</p>
<p>You should download this <a class="reference external" href="https://github.com/jhill1/SEPwC/raw/master/code_examples/gis_data.zip">zip file</a>
which contains the data required. Make sure you
change your working directory to match where you’ve downloaded the data.</p>
<section id="the-rasterio-library">
<h3>The <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> library<a class="headerlink" href="#the-rasterio-library" title="Link to this heading">#</a></h3>
<p id="index-8">The <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> library is used to load, manipulate and plot raster
data.</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id18" title="Link to this code">#</a></div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rasterio</span>

<span class="n">my_raster</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;gis_data/tidal_range.tif&quot;</span><span class="p">)</span>
<span class="n">my_raster</span>
</pre></div>
</div>
</div>
<p>Python will print out some basic info on the raster. This includes the filename
and the read/write status. <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> uses a number of attributes to contain information
about the raster:</p>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id19" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_raster</span><span class="o">.</span><span class="n">width</span>
<span class="n">my_raster</span><span class="o">.</span><span class="n">height</span>
<span class="n">my_raster</span><span class="o">.</span><span class="n">nodata</span>
</pre></div>
</div>
</div>
<p>For this raster dataset, there is a single band. Rasters can store multiple
bands in a single file. It’s common, for example, to store the R, G and B
colours separately. You can check this using the <code class="docutils literal notranslate"><span class="pre">count</span></code> attribute:</p>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id20" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_raster</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
</div>
<p>Raster data can contain missing data, held in the <code class="docutils literal notranslate"><span class="pre">nodata</span></code> property of
the raster. This value tells any reader to ignore this cell. When loading in Python,
these values will be assigned as <code class="docutils literal notranslate"><span class="pre">nan</span></code> in the variable where you load the raster.
The actual value could be anything, but common values include <code class="docutils literal notranslate"><span class="pre">-9999</span></code> and <code class="docutils literal notranslate"><span class="pre">-3.4e+38</span></code>.
When plotting in Python, those <code class="docutils literal notranslate"><span class="pre">nan</span></code> will be transparent, but you can choose another
colour.</p>
<p>The data in the raster contains the Coordinate Reference System (CRS) otherwise
known as the projection space. This tells you where that raster is located
and what the coordinates mean (metres, degrees, etc). You can also change that
projection space using the <code class="docutils literal notranslate"><span class="pre">reproject()</span></code> function from <code class="docutils literal notranslate"><span class="pre">rasterio.warp</span></code>. When you project onto another
CRS you will change your data. By default the projection will use
nearest neighbour interpolation to generate the data at the new coordinates. You can
change this to bilinear, cubic, or cubic-spline or use another algorithm. Use
bilinear unless you have a reason not to. The algorithms are in
<code class="docutils literal notranslate"><span class="pre">rasterio.warp.Resampling</span></code>.</p>
<div class="admonition-thought-exercise admonition">
<p class="admonition-title">Thought exercise</p>
<p>Have a search using a popular search engine to see if you can figure out
why bilinear interpolation is default.</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<p>Bilinear interpolation will not add any new values to the new data. The
new data maximum value will be equal to, or slightly less, than the old data;
and likewise, the minimum will be the same or slightly greater. Cubic or cubicspline
can <em>overshoot</em> the limits of the old data, but can also produce smoother data,
without abrupt changes. Whenever you project onto a new coordinate syste, you
are altering the data.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id21" title="Link to this code">#</a></div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rasterio.warp</span> <span class="kn">import</span> <span class="n">calculate_default_transform</span><span class="p">,</span> <span class="n">reproject</span><span class="p">,</span> <span class="n">Resampling</span>

<span class="n">dstCrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;init&#39;</span><span class="p">:</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">}</span>
<span class="c1"># we need to work out the new shape and size of rthe destination</span>
<span class="n">transform</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">calculate_default_transform</span><span class="p">(</span>
    <span class="n">my_raster</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">dstCrs</span><span class="p">,</span> <span class="n">my_raster</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">my_raster</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="o">*</span><span class="n">my_raster</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
<span class="c1"># we need to setup the meta data for the new raster</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="n">my_raster</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
    <span class="s1">&#39;crs&#39;</span><span class="p">:</span> <span class="n">dstCrs</span><span class="p">,</span>
    <span class="s1">&#39;transform&#39;</span><span class="p">:</span> <span class="n">transform</span><span class="p">,</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">height</span>
<span class="p">})</span>
<span class="c1"># open a file for writing</span>
<span class="n">dstRst</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Reprojected.tif&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="c1"># reproject</span>
<span class="n">reproject</span><span class="p">(</span>
    <span class="n">source</span><span class="o">=</span><span class="n">rasterio</span><span class="o">.</span><span class="n">band</span><span class="p">(</span><span class="n">my_raster</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">destination</span><span class="o">=</span><span class="n">rasterio</span><span class="o">.</span><span class="n">band</span><span class="p">(</span><span class="n">dstRst</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">src_crs</span><span class="o">=</span><span class="n">my_raster</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
    <span class="n">dst_crs</span><span class="o">=</span><span class="n">dstCrs</span><span class="p">,</span>
    <span class="n">resampling</span><span class="o">=</span><span class="n">Resampling</span><span class="o">.</span><span class="n">bilinear</span><span class="p">)</span>
<span class="c1"># close the file</span>
<span class="n">dstRst</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The raster is transformed from the original project space (UTM 31N) to a lat/lon
projection space: WGS84. This is quite complex bit of code. You first define the
new CRS. You then calculate the transform needed (.e.g how big the new raster needs to
be). You then set-up a new file to put the transformed raster in. <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> just
deals with raster on disk, not memory so everything needs to be saved to a file somewhere.
Finally, the data are reprojected, and then the file closed to save the data.</p>
<p>When dealing with raster data you often need the rasters to be identical;
same resolution, same extents, same projection space. Once identical, then
simple calculations (and indeed more complex ones!) can be carried out.</p>
</section>
<section id="the-geopandas-library">
<h3>The <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> library<a class="headerlink" href="#the-geopandas-library" title="Link to this heading">#</a></h3>
<p id="index-9"><code class="docutils literal notranslate"><span class="pre">geopandas</span></code> is the geographical equivalent to <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. It deals with dataframes
but those dataframes have a <code class="docutils literal notranslate"><span class="pre">geometry</span></code> component. It therefore maps onto GIS Vector
data very well.</p>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id22" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span>

<span class="n">tide_gauges</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;gis_data/tide_gauges.shp&quot;</span><span class="p">)</span>
<span class="n">tide_gauges</span>
</pre></div>
</div>
</div>
<p>Vector data can be points, lines or polygons. The <code class="docutils literal notranslate"><span class="pre">geometry</span></code> column tells us this and is,
in fact, a <code class="docutils literal notranslate"><span class="pre">shapely</span></code> object. <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> can carry out a number of geometric calculations, e.g.
distances:</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id23" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">whitby</span> <span class="o">=</span> <span class="n">tide_gauges</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">40</span><span class="p">]</span>
<span class="n">tide_gauges</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tide_gauges</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">whitby</span><span class="p">)</span>
<span class="n">tide_gauges</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> library has a number of functions, such as
sampling within a polygon, geometry calculations (differences, unions, intersections),
and geometric calculations (area, distances, lengths).</p>
</section>
<section id="the-shapely-library">
<h3>The <code class="docutils literal notranslate"><span class="pre">shapely</span></code> library<a class="headerlink" href="#the-shapely-library" title="Link to this heading">#</a></h3>
<p id="index-10"><code class="docutils literal notranslate"><span class="pre">shapely</span></code> is a library designed to do geometry calculations. It uses GIS Vector data
which can be loaded into a <code class="docutils literal notranslate"><span class="pre">Geometry</span></code>. You can also create geometries very easily in
<code class="docutils literal notranslate"><span class="pre">shapely</span></code>. However, you often don’t need to use the main functions in <code class="docutils literal notranslate"><span class="pre">shapely</span></code> itself
as <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> is built on top of <code class="docutils literal notranslate"><span class="pre">shapely</span></code>. It’s often needed for creating new
vector data though.</p>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text"><a class="reference internal" href="_images/Python-logo-notext.png"><img alt="python" src="_images/Python-logo-notext.png" style="height: 16px;" /></a></span><a class="headerlink" href="#id24" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">box</span>

<span class="n">my_box</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="o">*</span><span class="n">my_raster</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This creates a polygon using the extent (bounds) of the raster object we loaded earlier.</p>
<p>You can similar create points, lines, etc. Most of the geometric operations in <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>
come from <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, including things like <code class="docutils literal notranslate"><span class="pre">within</span></code>, <code class="docutils literal notranslate"><span class="pre">intersects</span></code>, etc.</p>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tides_python.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mini course: Tidal analysis in Python</p>
      </div>
    </a>
    <a class="right-next"
       href="genindex.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">&lt;no title&gt;</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis">GIS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-data">Vector data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raster-data">Raster data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-references-system">Coordinate References System</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-r">GIS - R</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-terra-library">The <code class="docutils literal notranslate"><span class="pre">terra</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-sf-library">The <code class="docutils literal notranslate"><span class="pre">sf</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#switching-between-the-two">Switching between the two</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-python">GIS - Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-rasterio-library">The <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-geopandas-library">The <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> library</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-shapely-library">The <code class="docutils literal notranslate"><span class="pre">shapely</span></code> library</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jon Hill
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jon Hill.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>