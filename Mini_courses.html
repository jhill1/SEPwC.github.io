
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GPHGXML15W"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-GPHGXML15W');
    </script>
    
    <title>Mini-courses &#8212; SEPwC  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Mini_courses';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Index" href="genindex.html" />
    <link rel="prev" title="Software development" href="Software_development.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">SEPwC  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="How_a_computer_works.html">How a computer works</a></li>
<li class="toctree-l1"><a class="reference internal" href="Licences.html">Software licences</a></li>
<li class="toctree-l1"><a class="reference internal" href="Code_basics.html">The fundamentals of code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Thinking like a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python.html">Python: the fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="R.html">R: the fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="Issues.html">Solving issues and debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Revision_control.html">Revision control with Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python2.html">Python: part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="R2.html">R: part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python3.html">Python: part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="R3.html">R: part 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="Spreadsheets_data.html">Moving from spreadsheets to data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Testing_code.html">Testing code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Software_development.html">Software development</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mini-courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/jhill1/SEPwC.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Mini_courses.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mini-courses</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ggplot2-tutorial">ggplot2 tutorial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataset">The dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-basics">Plotting basics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#themes">Themes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axes">Axes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-limits-and-scales">Axes limits and scales</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-legends">Plot legends</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colours">Colours</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-plots">Multiple plots</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#facets">Facets</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-plot">Saving the plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyplot-tutorial">Pyplot tutorial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-pyplot">Introduction to pyplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formatting-the-style-of-your-plot">Formatting the style of your plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-with-keyword-strings">Plotting with keyword strings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-with-categorical-variables">Plotting with categorical variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-line-properties">Controlling line properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-multiple-figures-and-axes">Working with multiple figures and axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-text">Working with text</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mathematical-expressions-in-text">Using mathematical expressions in text</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#annotating-text">Annotating text</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logarithmic-and-other-nonlinear-axes">Logarithmic and other nonlinear axes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sentiment-analysis">Sentiment Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pipeline-in-r">The pipeline in R</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-inner-join-to-get-the-sentiments-from-your-data">Using the <cite>inner join</cite> to get the sentiments from your data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidal-analysis-in-python">Tidal analysis in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sine-curves">Sine Curves</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis">GIS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-data">Vector data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raster-data">Raster data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coredinate-references-system-crs">Coredinate References System (CRS)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-r">GIS - R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-python">GIS - Python</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="mini-courses">
<h1>Mini-courses<a class="headerlink" href="#mini-courses" title="Link to this heading">#</a></h1>
<section id="ggplot2-tutorial">
<h2>ggplot2 tutorial<a class="headerlink" href="#ggplot2-tutorial" title="Link to this heading">#</a></h2>
<p id="index-0"><code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> is a popular library for creating pretty graphs and figures in R. It
works in a simialr way to the tidyverse in terms of using dataframes as the basic data
and then adding layers on top to create the final plot.</p>
<p>This section is based on the tutorial by
<a class="reference external" href="https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/">Cedric Scherer</a></p>
<p><code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> is also used as a basis for other graphing packages, such as <code class="docutils literal notranslate"><span class="pre">ggpubr</span></code> which simplifies some
of the syntax here to create publicaiton-level quality graphs. By learning <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> you should find
<code class="docutils literal notranslate"><span class="pre">ggpubr</span></code> very easy to use and have the knowledge to create more bespoke plots where needed.</p>
<section id="the-dataset">
<h3>The dataset<a class="headerlink" href="#the-dataset" title="Link to this heading">#</a></h3>
<p>We are using data from the National Morbidity and Mortality Air Pollution Study (NMMAPS).
To make the plots manageable we are limiting the data to Chicago and 1997–2000. For more detail
on this data set, consult Roger Peng’s book Statistical Methods in Environmental Epidemiology
with R. You can download the data we are using during this tutorial here (but you don’t have to).</p>
<p>We can import the data into our R session for example with read_csv() from the {readr} package.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">chic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://cedricscherer.com/data/chicago-nmmaps-custom.csv&quot;</span><span class="p">)</span>
<span class="n">tibble</span><span class="o">::</span><span class="nf">glimpse</span><span class="p">(</span><span class="n">chic</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plotting-basics">
<h3>Plotting basics<a class="headerlink" href="#plotting-basics" title="Link to this heading">#</a></h3>
<p>A ggplot is built up from a few basic elements:</p>
<ol class="arabic simple">
<li><p>Data: The raw data that you want to plot.</p></li>
<li><p>Geometries <code class="docutils literal notranslate"><span class="pre">geom_</span></code>: The geometric shapes that will represent the data.</p></li>
<li><p>Aesthetics <code class="docutils literal notranslate"><span class="pre">aes()</span></code>: Aesthetics of the geometric and statistical objects, such as position, color, size, shape, and transparency</p></li>
<li><p>Scales <code class="docutils literal notranslate"><span class="pre">scale_</span></code>: Maps between the data and the aesthetic dimensions, such as data range to plot width or factor values to colors.</p></li>
<li><p>Statistical transformations <code class="docutils literal notranslate"><span class="pre">stat_</span></code>: Statistical summaries of the data, such as quantiles, fitted curves, and sums.</p></li>
<li><p>Coordinate system <code class="docutils literal notranslate"><span class="pre">coord_</span></code>: The transformation used for mapping data coordinates into the plane of the data rectangle.</p></li>
<li><p>Facets <code class="docutils literal notranslate"><span class="pre">facet_</span></code>: The arrangement of the data into a grid of plots.</p></li>
<li><p>Visual themes <code class="docutils literal notranslate"><span class="pre">theme()</span></code>: The overall visual defaults of a plot, such as background, grids, axes, default typeface, sizes and colors.</p></li>
</ol>
<p>You need to specify the <code class="docutils literal notranslate"><span class="pre">data</span></code>, <code class="docutils literal notranslate"><span class="pre">geometry</span></code> and <code class="docutils literal notranslate"><span class="pre">aesthetics</span></code> as a minimum. To build up a ggplot we tell
ggplot the data, e.g. <code class="docutils literal notranslate"><span class="pre">ggplot(data</span> <span class="pre">=</span> <span class="pre">df)</span></code>. We then tell it which variables to plot i nthe aesthetics: <code class="docutils literal notranslate"><span class="pre">aes(x=var1,</span> <span class="pre">y=var2)</span>
<span class="pre">and</span> <span class="pre">then</span> <span class="pre">we</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">say</span> <span class="pre">what</span> <span class="pre">kind</span> <span class="pre">of</span> <span class="pre">plot</span> <span class="pre">via</span> <span class="pre">the</span> <span class="pre">geometry:</span> <span class="pre">``geom_point()</span></code>:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span>
<span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that we’ve stored the plot into an object, <cite>g</cite>. To display, we simply type <cite>g</cite> to the R console. However, here,
I’ve added  line geometry too. You can add other things to <cite>g</cite> on the fly:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
<p>(this will display immediately and does not affect the <code class="docutils literal notranslate"><span class="pre">g</span></code> object. Try plotting just <code class="docutils literal notranslate"><span class="pre">g</span> <span class="pre">+</span> <span class="pre">geom_line()</span></code> again).</p>
<p>You can maniuplate aspects of the geometry directly in the geometry function:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="s">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that ggplot2 understand <code class="docutils literal notranslate"><span class="pre">colour</span></code>, <code class="docutils literal notranslate"><span class="pre">color</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> and, of course, you can add more geometries:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;diamond&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dotted&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="themes">
<h3>Themes<a class="headerlink" href="#themes" title="Link to this heading">#</a></h3>
<p>Themes allow the setting up of axes, grids, fonts etc in a consistant way. <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> comes with a
number of built-in themes.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">theme_set</span><span class="p">(</span><span class="nf">theme_bw</span><span class="p">())</span>

<span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">theme_set</span></code> alters all plots in your current R session (or script). You can apply a theme to a
particular plot only too. Many aspects of the plot can be altered via the <code class="docutils literal notranslate"><span class="pre">theme()</span></code> function.
To see which details of a ggplot theme can be modified have a look here — and take some time; it’s a long list.
<a class="reference external" href="https://ggplot2.tidyverse.org/reference/theme.html">https://ggplot2.tidyverse.org/reference/theme.html</a></p>
</section>
<section id="axes">
<h3>Axes<a class="headerlink" href="#axes" title="Link to this heading">#</a></h3>
<p>The default axes titles use the variable names. Let’s add some well-written labels to the axes.
For this, we add labs() providing a character string for each label we want to change (here x and y):</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note, we’re not saving the plot object into a variable and are instead instantly plotting it.</p>
<p><code class="docutils literal notranslate"><span class="pre">theme()</span></code> is an essential command to modify particular theme elements (texts and titles,
boxes, symbols, backgrounds, etc). We are going to use them a lot! For now, we are going to modify
text elements. We can change the properties of all or particular text elements (here axis titles)
by overwriting the default <code class="docutils literal notranslate"><span class="pre">element_text()</span></code> within the <code class="docutils literal notranslate"><span class="pre">theme()</span></code> call:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span>
<span class="w">             </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">))</span>
</pre></div>
</div>
<p>We’ve adjusted the font size and the vertical positioning. Note that the <code class="docutils literal notranslate"><span class="pre">vjust</span></code> is the same of the positioning
of the horizontal axis; i.e. along the axis. There are a lot of things you can alter, but font size and positioning are
the crucial ones to know about.</p>
<p>The font axes text can also be altered:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dodgerblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">             </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">face</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;italic&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>This includes rotating the labels:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">))</span>
</pre></div>
</div>
<p>And removing ticks and text (not advised!):</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.ticks.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span>
<span class="w">             </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">())</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">element_blonk()</span></code> functions allows to remove any aspect of the theme, e.g. axes labels, if you wish.</p>
<section id="axes-limits-and-scales">
<h4>Axes limits and scales<a class="headerlink" href="#axes-limits-and-scales" title="Link to this heading">#</a></h4>
<p>A key part of producing attractive plots is the scale and limits of the axes. Using these you can ensure the
data are plotted correctly, e.g. on log-log axes or the key part of the data can be shown. You can, of course,
subset your data to do this, but you can also</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;firebrick&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">ylim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">))</span>
</pre></div>
</div>
<p>There are other ways of limiting the plot using <code class="docutils literal notranslate"><span class="pre">scale_y_continuous(limits</span> <span class="pre">=</span> <span class="pre">c(0,50))</span></code> or
<code class="docutils literal notranslate"><span class="pre">coord_cartesian(ylim</span> <span class="pre">=</span> <span class="pre">c(0,50))</span></code>. These give similar results, but are, in fact, slightly different.
Try them both instead of the <code class="docutils literal notranslate"><span class="pre">ylim()</span></code>.</p>
<img alt="Graphs plotted using the ylim or scale (left) vs the coord_cartesian (right)." src="_images/axis-limit-comp-1.png" />
<p>Note the lack of buffer on the <code class="docutils literal notranslate"><span class="pre">coord_cartesian()</span></code> plot, compared to the <code class="docutils literal notranslate"><span class="pre">scale_y_continuous()</span></code> plot?
This is the difference between subsetting (<code class="docutils literal notranslate"><span class="pre">scale_y_continuous</span></code> and <code class="docutils literal notranslate"><span class="pre">ylim()</span></code>) and clipping (<code class="docutils literal notranslate"><span class="pre">coord_cartesian()</span></code>).
This is even more pronounced on a box-whisker plot:</p>
<img alt="Boxplots plotted using the ylim or scale (left) vs the coord_cartesian (right)." src="_images/axis-limit-comp-box-1.png" />
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Notice the median lines are different here! If you scale or impose <code class="docutils literal notranslate"><span class="pre">ylim</span></code> it is worth checking your data without
limits first! In other word, build up your plot carefully and also run the stats within R, not just rely on reading
the graphs…</p>
</div>
<p>You can force R to plot starting from some coordinates, e.g. the (0,0) origin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chic_high</span> <span class="o">&lt;-</span> <span class="n">dplyr</span><span class="p">::</span><span class="nb">filter</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">,</span> <span class="n">o3</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">chic_high</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">o3</span><span class="p">))</span> <span class="o">+</span>
       <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkcyan&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Temperature higher than 25°F&quot;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Ozone higher than 20 ppb&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">expand_limits</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>But we can also force it to literally start at the origin!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">chic_high</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">o3</span><span class="p">))</span> <span class="o">+</span>
       <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkcyan&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Temperature higher than 25°F&quot;</span><span class="p">,</span>
            <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Ozone higher than 20 ppb&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">expand_limits</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">coord_cartesian</span><span class="p">(</span><span class="n">expand</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">clip</span> <span class="o">=</span> <span class="s2">&quot;off&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The argument clip = “off” in any coordinate system (<code class="docutils literal notranslate"><span class="pre">coord_*</span></code>), allows to draw outside of the panel area.</p>
</div>
<p>Scaling is an important part of plotting. If you are expecting a 1:1 ratio between your variables, creating
a plot with the axes scaled to that helps visualisation. For demonstrating purposes, let’s plot temperature
against temperature with some random noise. The coord_equal() is a coordinate system with a specified ratio
representing the number of units on the y-axis equivalent to one unit on the x-axis. The default, ratio = 1,
ensures that one unit on the x-axis is the same length as one unit on the y-axis:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">chic</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;sienna&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F) + random noise&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">xlim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylim</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">150</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">coord_fixed</span><span class="p">()</span>
</pre></div>
</div>
<p>Ratios larger than 1 make the units on the y-axis long thatn those on the x, and
vice-versa:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">temp</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="n">rnorm</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">chic</span><span class="p">),</span> <span class="n">sd</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)))</span> <span class="o">+</span>
       <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;sienna&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Temperature (°F)&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Temperature (°F) + random noise&quot;</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">xlim</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="n">ylim</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">))</span> <span class="o">+</span>
       <span class="n">coord_fixed</span><span class="p">(</span><span class="n">ratio</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="plot-legends">
<h3>Plot legends<a class="headerlink" href="#plot-legends" title="Link to this heading">#</a></h3>
<p>We often colour code parts of our graphs, and then add a legend to show how the data are separated.
We will <code class="docutils literal notranslate"><span class="pre">color</span></code> code the plot based on season. Or to phrase it in a more <code class="docutils literal notranslate"><span class="pre">ggplot</span></code>’ish way: we map the
variable season to the aesthetic <code class="docutils literal notranslate"><span class="pre">color</span></code>. One nice thing about <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> is that it adds a legend by
default when mapping a variable to an aesthetic. You can see that by default the legend title is
what we specified in the <code class="docutils literal notranslate"><span class="pre">color</span></code> argument:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
<span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>How can you remove the legend if it’s added by default?</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
<span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">guides(color</span> <span class="pre">=</span> <span class="pre">&quot;none&quot;)</span></code> or <code class="docutils literal notranslate"><span class="pre">scale_color_discrete(guide</span> <span class="pre">=</span> <span class="pre">&quot;none&quot;)</span></code> depending on
the specific case. While the change of the theme element removes all legends at once,
you can remove particular legends with the latter options while keeping some others:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
<span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span>
<span class="w">       </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">guides</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we’ve kept the legend for the shape, but not colour. Note that the aesthetics is where
we map shape and colour. If we do it outside the aesthetic we don’t get a legend for that property.</p>
<p>We can remove titles for legend using the <code class="docutils literal notranslate"><span class="pre">element_blank()</span></code>:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">())</span>
</pre></div>
</div>
<p>And also chnage the position:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;top&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The possible options are “top”, “right”, “left” and “bottom”. You can also specify
a coordinate for the legend to be from 0 to 1 (0 is the left/bottom, 1 is the right/top):</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">.</span><span class="m">15</span><span class="p">),</span>
<span class="w">      </span><span class="n">legend.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;transparent&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>The legend also has a transparent background here to make sure no points are hidden. You can also switch the
direction:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">.</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">.</span><span class="m">97</span><span class="p">),</span>
<span class="w">      </span><span class="n">legend.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;transparent&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">guides</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">guide_legend</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;horizontal&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>The default title is dictated by the variable name, just as the axes. To change it
to something more readable use the <code class="docutils literal notranslate"><span class="pre">labs()</span></code> function:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span>
<span class="w">     </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Seasons\nindicated\nby colors:&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You will probably want to alter the order in which the legend elements appear, e.g. for
seasons, putting them in order makes sense. We can’t that in <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> and instead we
have to alter the variable in the dataframe itself. We alter the <code class="docutils literal notranslate"><span class="pre">levels</span></code> in the <code class="docutils literal notranslate"><span class="pre">season</span></code>
column:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">chic</span><span class="o">$</span><span class="n">season</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">    </span><span class="nf">factor</span><span class="p">(</span><span class="n">chic</span><span class="o">$</span><span class="n">season</span><span class="p">,</span>
<span class="w">           </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Winter&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Spring&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Summer&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Autumn&quot;</span><span class="p">))</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can alter the labels though easily in <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">scale_color_discrete</span><span class="p">(</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Seasons:&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Mar—May&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Jun—Aug&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sep—Nov&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Dec—Feb&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If you add multiple geometries you will find the legend has them all on too, for example:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_rug</span><span class="p">()</span>
</pre></div>
</div>
<p>Note the line in the legend symbols? This comes from the <code class="docutils literal notranslate"><span class="pre">geom_rug()</span></code>. To turn it off
you add the <code class="docutils literal notranslate"><span class="pre">show.legend</span> <span class="pre">=</span> <span class="pre">FALSE</span></code> to the <code class="docutils literal notranslate"><span class="pre">geom_*()</span></code> call:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_rug</span><span class="p">(</span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
<p>The examples above are for discrete or categorical data. <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> also shows legends
for continuous data, such as the temperature:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span>
<span class="w">       </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is possible to force discrete legends or binned legends too.</p>
<section id="colours">
<h4>Colours<a class="headerlink" href="#colours" title="Link to this heading">#</a></h4>
<p>A key part of the plot is the colour scheme chosen. There are two main
colour elements to alter; <code class="docutils literal notranslate"><span class="pre">color</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code>. These can be either a single colour
or assigned to a variable. For a specified colour add the colour to the <code class="docutils literal notranslate"><span class="pre">geometry()</span></code>
function:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">21</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">stroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">           </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;#3cc08f&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;#c08f3c&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, I’ve specifed the <code class="docutils literal notranslate"><span class="pre">color</span></code> and the <code class="docutils literal notranslate"><span class="pre">fill</span></code>. The <code class="docutils literal notranslate"><span class="pre">color</span></code> is
used as an outline, where the <code class="docutils literal notranslate"><span class="pre">fill</span></code> is used in the centre of the shape.
Note I’ve also had to specify a stroke (the outline) to show the this. Also note
I’ve specified colours using hexidecimal codes. These are the R(ed) G(reen) B(lue)
components in values of 0 to 255 in hexidecimal. There are lot of webpages
to find the hex codes of colours around.</p>
<p>You can also asign a palatte to a colour. This is obviously most useful when assign
colour to a variable. You can alter these using the <code class="docutils literal notranslate"><span class="pre">scale_color_*</span></code> and <code class="docutils literal notranslate"><span class="pre">scale_fill_*</span></code>
functions. You can also manually create a palette.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ga</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">       </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">))</span>
</pre></div>
</div>
<p>We’ve created a <code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> object, <code class="docutils literal notranslate"><span class="pre">ga</span></code> with the default palette. Now lets
alter this:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">ga</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">scale_color_brewer</span><span class="p">(</span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To use the <code class="docutils literal notranslate"><span class="pre">Set1</span></code> scheme from R Color Brewer. If we wanted to set our own colours:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">ga</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;dodgerblue4&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="s">&quot;darkolivegreen4&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="s">&quot;darkorchid3&quot;</span><span class="p">,</span>
<span class="w">                                   </span><span class="s">&quot;goldenrod1&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>For continuous variables we need the <code class="docutils literal notranslate"><span class="pre">scale_*_gradient()</span></code> or <code class="docutils literal notranslate"><span class="pre">scale_*_continuous()</span></code>
functions:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">gb</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">             </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">             </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F):&quot;</span><span class="p">)</span>

<span class="n">gb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">scale_color_continuous</span><span class="p">()</span>
</pre></div>
</div>
<p>We can use a diverging colour scheme:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">mid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">chic</span><span class="o">$</span><span class="n">temp</span><span class="p">)</span><span class="w">  </span><span class="c1">## midpoint</span>
<span class="n">gb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">scale_color_gradient2</span><span class="p">(</span><span class="n">midpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mid</span><span class="p">)</span>
</pre></div>
</div>
<p>It is possible to specify your own colour palette, but I would recommend sticking to
pre-defined ones, espesially the <code class="docutils literal notranslate"><span class="pre">viridis</span></code> set, which are colour-blind safe.</p>
<blockquote>
<div><p>p1 &lt;- gb + scale_color_viridis_c() + ggtitle(“‘viridis’ (default)”)
p2 &lt;- gb + scale_color_viridis_c(option = “inferno”) + ggtitle(“‘inferno’”)
p3 &lt;- gb + scale_color_viridis_c(option = “plasma”) + ggtitle(“‘plasma’”)
p4 &lt;- gb + scale_color_viridis_c(option = “cividis”) + ggtitle(“‘cividis’”)</p>
<p>library(patchwork)
(p1 + p2 + p3 + p4) * theme(legend.position = “bottom”)</p>
</div></blockquote>
</section>
</section>
<section id="multiple-plots">
<h3>Multiple plots<a class="headerlink" href="#multiple-plots" title="Link to this heading">#</a></h3>
<p>In the last example I snuck in an example of adding multiple plots to a figure!
There are two main ways to do this: using the built-in <code class="docutils literal notranslate"><span class="pre">facet</span></code> or using an external
package, such as <code class="docutils literal notranslate"><span class="pre">patchwork</span></code>.</p>
<section id="facets">
<h4>Facets<a class="headerlink" href="#facets" title="Link to this heading">#</a></h4>
<p>Facets act on a variable in your data so are an easy way to separate out components.
There are two ways to do this using either <code class="docutils literal notranslate"><span class="pre">facet_grid</span></code> or <code class="docutils literal notranslate"><span class="pre">facet_wrap</span></code>. The first
can produce a grid based on one or two variables. The latter produces a “ribbon” of plots.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;orangered&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="nf">facet_grid</span><span class="p">(</span><span class="n">year</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">season</span><span class="p">)</span>
</pre></div>
</div>
<p>Try the above with <code class="docutils literal notranslate"><span class="pre">facet_grid(season</span> <span class="pre">~</span> <span class="pre">year)</span></code> too. The <code class="docutils literal notranslate"><span class="pre">facet_wrap</span></code> produces something similar:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">chic</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">     </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;chartreuse4&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">     </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Year&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Temperature (°F)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">     </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<p>There are a number of other options to tailor the plot just to your liking. In the above
example, the wrap uses the same axis (this is generally what you would want!), but here, we don’t.
We can alter using the <code class="docutils literal notranslate"><span class="pre">scales</span> <span class="pre">=</span> <span class="pre">&quot;free&quot;</span></code>:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;free&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If we use two variables with <code class="docutils literal notranslate"><span class="pre">facet_wrap</span></code> we can a slightly different view:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="n">year</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;free_x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="saving-the-plot">
<h3>Saving the plot<a class="headerlink" href="#saving-the-plot" title="Link to this heading">#</a></h3>
<p>Assuming you have saved your plot into an object you can save the plot to a file using
the <code class="docutils literal notranslate"><span class="pre">ggsave()</span></code> function:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;output_filename.pdf&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="o">=</span><span class="n">final_plot</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">297</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="o">=</span><span class="m">210</span><span class="p">,</span><span class="w"> </span><span class="n">units</span><span class="o">=</span><span class="s">&quot;mm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This saves an A4 PDF of the <code class="docutils literal notranslate"><span class="pre">final_plot</span></code> object. Look up the <code class="docutils literal notranslate"><span class="pre">ggsave</span></code> function for more options.</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">patchwork</span></code> (or <code class="docutils literal notranslate"><span class="pre">ggarange</span></code> or any other package to place multiple plots together) that
object is the output of the <code class="docutils literal notranslate"><span class="pre">patchwork</span></code> call:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">final_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">p1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p4</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bottom&quot;</span><span class="p">)</span>
<span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;output_filename.pdf&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="o">=</span><span class="n">final_plot</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">297</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="o">=</span><span class="m">210</span><span class="p">,</span><span class="w"> </span><span class="n">units</span><span class="o">=</span><span class="s">&quot;mm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="pyplot-tutorial">
<h2>Pyplot tutorial<a class="headerlink" href="#pyplot-tutorial" title="Link to this heading">#</a></h2>
<p id="index-1">This is based on the <code class="docutils literal notranslate"><span class="pre">pyplot</span></code> tutorial from the Matplotlib Development Team</p>
<p>An introduction to the pyplot interface. It’s worth reading the
extensive <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> documentation.</p>
<section id="introduction-to-pyplot">
<h3>Introduction to pyplot<a class="headerlink" href="#introduction-to-pyplot" title="Link to this heading">#</a></h3>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> is a collection of functions that make matplotlib
work like MATLAB.  Each <code class="docutils literal notranslate"><span class="pre">pyplot</span></code> function makes some change to a figure:
e.g., creates a figure, creates a plotting area in a figure, plots some lines
in a plotting area, decorates the plot with labels, etc.</p>
<p>In <code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> various states are preserved
across function calls, so that it keeps track of things like
the current figure and plotting area, and the plotting
functions are directed to the current axes (please note that “axes” here
and in most places in the documentation refers to the <em>axes</em>
part of a figure and not the strict mathematical term for more than one axis).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The implicit pyplot API is generally less verbose but also not as flexible as the
explicit API.  Most of the function calls you see here can also be called
as methods from an <code class="docutils literal notranslate"><span class="pre">Axes</span></code> object. We recommend browsing the online tutorials
and examples to see how this works.</p>
</div>
<p>Generating visualizations with pyplot is very quick:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;some numbers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>You may be wondering why the x-axis ranges from 0-3 and the y-axis
from 1-4.  If you provide a single list or array to
<cite>~.pyplot.plot</cite>, matplotlib assumes it is a
sequence of y values, and automatically generates the x values for
you.  Since python ranges start with 0, the default x vector has the
same length as y but starts with 0; therefore, the x data are
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>.</p>
<p><cite>~.pyplot.plot</cite> is a versatile function, and will take an arbitrary number of
arguments.  For example, to plot x versus y, you can write:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="formatting-the-style-of-your-plot">
<h3>Formatting the style of your plot<a class="headerlink" href="#formatting-the-style-of-your-plot" title="Link to this heading">#</a></h3>
<p id="index-2">For every x, y pair of arguments, there is an optional third argument
which is the format string that indicates the color and line type of
the plot.  The letters and symbols of the format string are from
MATLAB, and you concatenate a color string with a line style string.
The default format string is ‘b-’, which is a solid blue line.  For
example, to plot the above with red circles, you would issue</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>See the <cite>~.pyplot.plot</cite> documentation for a complete
list of line styles and format strings.  The
<cite>~.pyplot.axis</cite> function in the example above takes a
list of <code class="docutils literal notranslate"><span class="pre">[xmin,</span> <span class="pre">xmax,</span> <span class="pre">ymin,</span> <span class="pre">ymax]</span></code> and specifies the viewport of the
axes.</p>
<p>If matplotlib were limited to working with lists, it would be fairly
useless for numeric processing.  Generally, you will use <a class="reference external" href="https://numpy.org/">numpy</a> arrays.  In fact, all sequences are
converted to numpy arrays internally.  The example below illustrates
plotting several lines with different format styles in one function call
using arrays.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># evenly sampled time at 200ms intervals</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># red dashes, blue squares and green triangles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;g^&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="plotting-with-keyword-strings">
<h3>Plotting with keyword strings<a class="headerlink" href="#plotting-with-keyword-strings" title="Link to this heading">#</a></h3>
<p id="index-3">There are some instances where you have data in a format that lets you
access particular variables with strings. For example, with <a class="reference external" href="https://numpy.org/doc/stable/user/basics.rec.html#structured-arrays">structured arrays</a>
or <cite>pandas.DataFrame</cite>.</p>
<p>Matplotlib allows you to provide such an object with
the <code class="docutils literal notranslate"><span class="pre">data</span></code> keyword argument. If provided, then you may generate plots with
the strings corresponding to these variables.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)}</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;entry a&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;entry b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="plotting-with-categorical-variables">
<h3>Plotting with categorical variables<a class="headerlink" href="#plotting-with-categorical-variables" title="Link to this heading">#</a></h3>
<p id="index-4">It is also possible to create a plot using categorical variables.
Matplotlib allows you to pass categorical variables directly to
many plotting functions. For example:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;group_a&#39;</span><span class="p">,</span> <span class="s1">&#39;group_b&#39;</span><span class="p">,</span> <span class="s1">&#39;group_c&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Categorical Plotting&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="controlling-line-properties">
<h3>Controlling line properties<a class="headerlink" href="#controlling-line-properties" title="Link to this heading">#</a></h3>
<p id="index-5">Lines have many attributes that you can set: linewidth, dash style,
antialiased, etc; see <cite>matplotlib.lines.Line2D</cite>.  There are
several ways to set line properties</p>
<ul>
<li><p>Use keyword arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Use the setter methods of a <code class="docutils literal notranslate"><span class="pre">Line2D</span></code> instance.  <code class="docutils literal notranslate"><span class="pre">plot</span></code> returns a list
of <code class="docutils literal notranslate"><span class="pre">Line2D</span></code> objects; e.g., <code class="docutils literal notranslate"><span class="pre">line1,</span> <span class="pre">line2</span> <span class="pre">=</span> <span class="pre">plot(x1,</span> <span class="pre">y1,</span> <span class="pre">x2,</span> <span class="pre">y2)</span></code>.  In the code
below we will suppose that we have only
one line so that the list returned is of length 1.  We use tuple unpacking with
<code class="docutils literal notranslate"><span class="pre">line,</span></code> to get the first element of that list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">line</span><span class="o">.</span><span class="n">set_antialiased</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># turn off antialiasing</span>
</pre></div>
</div>
</li>
<li><p>Use <cite>~.pyplot.setp</cite>.  The example below
uses a MATLAB-style function to set multiple properties
on a list of lines.  <code class="docutils literal notranslate"><span class="pre">setp</span></code> works transparently with a list of objects
or a single object.  You can either use python keyword arguments or
MATLAB-style string/value pairs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="c1"># use keyword arguments</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="c1"># or MATLAB style string value pairs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Here are the available <cite>~.lines.Line2D</cite> properties.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Value Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>alpha</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>animated</p></td>
<td><p>[True | False]</p></td>
</tr>
<tr class="row-even"><td><p>antialiased or aa</p></td>
<td><p>[True | False]</p></td>
</tr>
<tr class="row-odd"><td><p>clip_box</p></td>
<td><p>a matplotlib.transform.Bbox instance</p></td>
</tr>
<tr class="row-even"><td><p>clip_on</p></td>
<td><p>[True | False]</p></td>
</tr>
<tr class="row-odd"><td><p>clip_path</p></td>
<td><p>a Path instance and a Transform instance, a Patch</p></td>
</tr>
<tr class="row-even"><td><p>color or c</p></td>
<td><p>any matplotlib color</p></td>
</tr>
<tr class="row-odd"><td><p>contains</p></td>
<td><p>the hit testing function</p></td>
</tr>
<tr class="row-even"><td><p>dash_capstyle</p></td>
<td><p>[<code class="docutils literal notranslate"><span class="pre">'butt'</span></code> | <code class="docutils literal notranslate"><span class="pre">'round'</span></code> | <code class="docutils literal notranslate"><span class="pre">'projecting'</span></code>]</p></td>
</tr>
<tr class="row-odd"><td><p>dash_joinstyle</p></td>
<td><p>[<code class="docutils literal notranslate"><span class="pre">'miter'</span></code> | <code class="docutils literal notranslate"><span class="pre">'round'</span></code> | <code class="docutils literal notranslate"><span class="pre">'bevel'</span></code>]</p></td>
</tr>
<tr class="row-even"><td><p>dashes</p></td>
<td><p>sequence of on/off ink in points</p></td>
</tr>
<tr class="row-odd"><td><p>data</p></td>
<td><p>(np.array xdata, np.array ydata)</p></td>
</tr>
<tr class="row-even"><td><p>figure</p></td>
<td><p>a matplotlib.figure.Figure instance</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>any string</p></td>
</tr>
<tr class="row-even"><td><p>linestyle or ls</p></td>
<td><p>[ <code class="docutils literal notranslate"><span class="pre">'-'</span></code> | <code class="docutils literal notranslate"><span class="pre">'--'</span></code> | <code class="docutils literal notranslate"><span class="pre">'-.'</span></code> | <code class="docutils literal notranslate"><span class="pre">':'</span></code> | <code class="docutils literal notranslate"><span class="pre">'steps'</span></code> | …]</p></td>
</tr>
<tr class="row-odd"><td><p>linewidth or lw</p></td>
<td><p>float value in points</p></td>
</tr>
<tr class="row-even"><td><p>marker</p></td>
<td><p>[ <code class="docutils literal notranslate"><span class="pre">'+'</span></code> | <code class="docutils literal notranslate"><span class="pre">','</span></code> | <code class="docutils literal notranslate"><span class="pre">'.'</span></code> | <code class="docutils literal notranslate"><span class="pre">'1'</span></code> | <code class="docutils literal notranslate"><span class="pre">'2'</span></code> | <code class="docutils literal notranslate"><span class="pre">'3'</span></code> | <code class="docutils literal notranslate"><span class="pre">'4'</span></code> ]</p></td>
</tr>
<tr class="row-odd"><td><p>markeredgecolor or mec</p></td>
<td><p>any matplotlib color</p></td>
</tr>
<tr class="row-even"><td><p>markeredgewidth or mew</p></td>
<td><p>float value in points</p></td>
</tr>
<tr class="row-odd"><td><p>markerfacecolor or mfc</p></td>
<td><p>any matplotlib color</p></td>
</tr>
<tr class="row-even"><td><p>markersize or ms</p></td>
<td><p>float</p></td>
</tr>
<tr class="row-odd"><td><p>markevery</p></td>
<td><p>[ None | integer | (startind, stride) ]</p></td>
</tr>
<tr class="row-even"><td><p>picker</p></td>
<td><p>used in interactive line selection</p></td>
</tr>
<tr class="row-odd"><td><p>pickradius</p></td>
<td><p>the line pick selection radius</p></td>
</tr>
<tr class="row-even"><td><p>solid_capstyle</p></td>
<td><p>[<code class="docutils literal notranslate"><span class="pre">'butt'</span></code> | <code class="docutils literal notranslate"><span class="pre">'round'</span></code> | <code class="docutils literal notranslate"><span class="pre">'projecting'</span></code>]</p></td>
</tr>
<tr class="row-odd"><td><p>solid_joinstyle</p></td>
<td><p>[<code class="docutils literal notranslate"><span class="pre">'miter'</span></code> | <code class="docutils literal notranslate"><span class="pre">'round'</span></code> | <code class="docutils literal notranslate"><span class="pre">'bevel'</span></code>]</p></td>
</tr>
<tr class="row-even"><td><p>transform</p></td>
<td><p>a matplotlib.transforms.Transform instance</p></td>
</tr>
<tr class="row-odd"><td><p>visible</p></td>
<td><p>[True | False]</p></td>
</tr>
<tr class="row-even"><td><p>xdata</p></td>
<td><p>np.array</p></td>
</tr>
<tr class="row-odd"><td><p>ydata</p></td>
<td><p>np.array</p></td>
</tr>
<tr class="row-even"><td><p>zorder</p></td>
<td><p>any number</p></td>
</tr>
</tbody>
</table>
<p>To get a list of settable line properties, call the
<cite>~.pyplot.setp</cite> function with a line or lines as argument</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">69</span><span class="p">]:</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">70</span><span class="p">]:</span> <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
  <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span>
  <span class="n">animated</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span> <span class="o">|</span> <span class="kc">False</span><span class="p">]</span>
  <span class="n">antialiased</span> <span class="ow">or</span> <span class="n">aa</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span> <span class="o">|</span> <span class="kc">False</span><span class="p">]</span>
  <span class="o">...</span><span class="n">snip</span>
</pre></div>
</div>
</section>
<section id="working-with-multiple-figures-and-axes">
<h3>Working with multiple figures and axes<a class="headerlink" href="#working-with-multiple-figures-and-axes" title="Link to this heading">#</a></h3>
<p id="index-7"><span id="index-6"></span>MATLAB, and <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyplot</span></code>, have the concept of the current figure
and the current axes.  All plotting functions apply to the current
axes.  The function <cite>~.pyplot.gca</cite> returns the current axes (a
<cite>matplotlib.axes.Axes</cite> instance), and <cite>~.pyplot.gcf</cite> returns the current
figure (a <cite>matplotlib.figure.Figure</cite> instance). Normally, you don’t have to
worry about this, because it is all taken care of behind the scenes.  Below
is a script to create two subplots.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t2</span><span class="p">),</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>~.pyplot.figure</cite> call here is optional because a figure will be created
if none exists, just as an Axes will be created (equivalent to an explicit
<code class="docutils literal notranslate"><span class="pre">subplot()</span></code> call) if none exists.
The <cite>~.pyplot.subplot</cite> call specifies <code class="docutils literal notranslate"><span class="pre">numrows,</span>
<span class="pre">numcols,</span> <span class="pre">plot_number</span></code> where <code class="docutils literal notranslate"><span class="pre">plot_number</span></code> ranges from 1 to
<code class="docutils literal notranslate"><span class="pre">numrows*numcols</span></code>.  The commas in the <code class="docutils literal notranslate"><span class="pre">subplot</span></code> call are
optional if <code class="docutils literal notranslate"><span class="pre">numrows*numcols&lt;10</span></code>.  So <code class="docutils literal notranslate"><span class="pre">subplot(211)</span></code> is identical
to <code class="docutils literal notranslate"><span class="pre">subplot(2,</span> <span class="pre">1,</span> <span class="pre">1)</span></code>.</p>
<p>You can create an arbitrary number of subplots
and axes.  If you want to place an Axes manually, i.e., not on a
rectangular grid, use <cite>~.pyplot.axes</cite>,
which allows you to specify the location as <code class="docutils literal notranslate"><span class="pre">axes([left,</span> <span class="pre">bottom,</span>
<span class="pre">width,</span> <span class="pre">height])</span></code> where all values are in fractional (0 to 1)
coordinates.</p>
<p>You can create multiple figures by using multiple
<cite>~.pyplot.figure</cite> calls with an increasing figure
number.  Of course, each figure can contain as many axes and subplots
as your heart desires:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                <span class="c1"># the first figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>             <span class="c1"># the first subplot in the first figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>             <span class="c1"># the second subplot in the first figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                <span class="c1"># a second figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>          <span class="c1"># creates a subplot() by default</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                <span class="c1"># first figure current;</span>
                             <span class="c1"># subplot(212) still current</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>             <span class="c1"># make subplot(211) in the first figure</span>
                             <span class="c1"># current</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Easy as 1, 2, 3&#39;</span><span class="p">)</span> <span class="c1"># subplot 211 title</span>
</pre></div>
</div>
<p>You can clear the current figure with <cite>~.pyplot.clf</cite>
and the current axes with <cite>~.pyplot.cla</cite>.  If you find
it annoying that states (specifically the current image, figure and axes)
are being maintained for you behind the scenes, don’t despair: this is just a thin
stateful wrapper around an object-oriented API, which you can use
instead.</p>
<p>If you are making lots of figures, you need to be aware of one
more thing: the memory required for a figure is not completely
released until the figure is explicitly closed with
<cite>~.pyplot.close</cite>.  Deleting all references to the
figure, and/or using the window manager to kill the window in which
the figure appears on the screen, is not enough, because pyplot
maintains internal references until <cite>~.pyplot.close</cite>
is called.</p>
</section>
<section id="working-with-text">
<span id="id1"></span><h3>Working with text<a class="headerlink" href="#working-with-text" title="Link to this heading">#</a></h3>
<p id="index-8"><cite>~.pyplot.text</cite> can be used to add text in an arbitrary location, and
<cite>~.pyplot.xlabel</cite>, <cite>~.pyplot.ylabel</cite> and <cite>~.pyplot.title</cite> are used to add
text in the indicated locations</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">15</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># the histogram of the data</span>
<span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Smarts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of IQ&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mf">.025</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu=100,\ \sigma=15$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>All of the <cite>~.pyplot.text</cite> functions return a <cite>matplotlib.text.Text</cite>
instance.  Just as with lines above, you can customize the properties by
passing keyword arguments into the text functions or using <cite>~.pyplot.setp</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;my data&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="using-mathematical-expressions-in-text">
<h4>Using mathematical expressions in text<a class="headerlink" href="#using-mathematical-expressions-in-text" title="Link to this heading">#</a></h4>
<p id="index-9">Matplotlib accepts TeX equation expressions in any text expression.
For example to write the expression <span class="math notranslate nohighlight">\(\sigma_i=15\)</span> in the title,
you can write a TeX expression surrounded by dollar signs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\sigma_i=15$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">r</span></code> preceding the title string is important – it signifies
that the string is a <em>raw</em> string and not to treat backslashes as
python escapes.  matplotlib has a built-in TeX expression parser and
layout engine, and ships its own math fonts.Thus, you can use mathematical text across
platforms without requiring a TeX installation.  For those who have LaTeX
and dvipng installed, you can also use LaTeX to format your text and
incorporate the output directly into your display figures or saved
postscript.</p>
</section>
<section id="annotating-text">
<h4>Annotating text<a class="headerlink" href="#annotating-text" title="Link to this heading">#</a></h4>
<p id="index-10">The uses of the basic <cite>~.pyplot.text</cite> function above
place text at an arbitrary position on the Axes.  A common use for
text is to annotate some feature of the plot, and the
<cite>~.pyplot.annotate</cite> method provides helper
functionality to make annotations easy.  In an annotation, there are
two points to consider: the location being annotated represented by
the argument <code class="docutils literal notranslate"><span class="pre">xy</span></code> and the location of the text <code class="docutils literal notranslate"><span class="pre">xytext</span></code>.  Both of
these arguments are <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> tuples.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;local max&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
             <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>In this basic example, both the <code class="docutils literal notranslate"><span class="pre">xy</span></code> (arrow tip) and <code class="docutils literal notranslate"><span class="pre">xytext</span></code>
locations (text location) are in data coordinates.  There are a
variety of other coordinate systems one can choose.</p>
</section>
</section>
<section id="logarithmic-and-other-nonlinear-axes">
<h3>Logarithmic and other nonlinear axes<a class="headerlink" href="#logarithmic-and-other-nonlinear-axes" title="Link to this heading">#</a></h3>
<p id="index-12"><span id="index-11"></span><code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> supports not only linear axis scales, but also
logarithmic and logit scales. This is commonly used if data spans many orders
of magnitude. Changing the scale of an axis is easy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An example of four plots with the same data and different scales for the y-axis
is shown below.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fixing random state for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">19680801</span><span class="p">)</span>

<span class="c1"># make up some data in the open interval (0, 1)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">y</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

<span class="c1"># plot with various axes scales</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># linear</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># log</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># symmetric log</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># logit</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;logit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;logit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Adjust the subplot layout, because the logit one may take more space</span>
<span class="c1"># than usual, due to y-tick labels like &quot;1 - 10^{-3}&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                    <span class="n">wspace</span><span class="o">=</span><span class="mf">0.35</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>It is also possible to add your own scale, see <cite>matplotlib.scale</cite> for
details.</p>
</section>
</section>
<section id="sentiment-analysis">
<h2>Sentiment Analysis<a class="headerlink" href="#sentiment-analysis" title="Link to this heading">#</a></h2>
<p>Sentiment analysis or opinion mining is a way of extracting feelings from large amounts of text. When
we read text we can use our understanding of the words to derive an emotion from the text the
author is trying to convey. This can be characterised as <em>positive</em> or <em>negative</em> or even in
more nuanced emotions like <em>joy</em> or <em>anger</em>.</p>
<p>This section is heavily based on <a class="reference external" href="https://www.tidytextmining.com/sentiment.html">“Text Mining with R”</a></p>
<section id="the-pipeline-in-r">
<h3>The pipeline in R<a class="headerlink" href="#the-pipeline-in-r" title="Link to this heading">#</a></h3>
<p>We can use R’s <cite>tidyverse</cite>, along with <cite>tidytext</cite>, data structures to perform these kinds of analyses quite easily,
building a pipeline, something like this:</p>
<p>The Sentiment lexicon is the key to this. The simpliest way to analyse text is to break it into tokens: words.
Obviously, this is a bit simplisitc, we could have a positive word “great”, preceeded by a negative one “not”,
which flips the entire meaning. However, the idea behind sentiment analysis is to analyse vast amounts of text,
so these issues get lost as noise. It’s something you need to be aware of though if you want to do
this on real data.</p>
<p>There are three <cite>sentiment</cite> databases, packaged into a R library, we can use for general-purpose analysis:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>AFINN</cite> from <a class="reference external" href="http://www2.imm.dtu.dk/pubdb/views/publication_details.php?id=6010">Finn Årup Nielsen</a></p></li>
<li><p><cite>bing</cite> from <a class="reference external" href="https://www.cs.uic.edu/~liub/FBS/sentiment-analysis.html">Bing Liu and collaborators</a></p></li>
<li><p><cite>nrc</cite> from <a class="reference external" href="http://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm">Saif Mohammad and Peter Turney</a></p></li>
</ul>
</div></blockquote>
<p>All of these are based on unigrams; single words, and are in English only. The <cite>nrc</cite> classifies
words in a binary fashion (i.e. yes/no) into categorieis of poisitve, negative, anger, joy, sadness, etc.
The <cite>bing</cite> lexicon categorises words into positive or negative. The <cite>AFINN</cite> lexicon creates a score between
-5 and 5 to show the sentiment (on a negative to positive scale).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each lexicon has a licence. You’ll need to agree to the licence before using it. You will
need to check if that licence is OK with your project. See <a class="reference internal" href="Licences.html#software-licences"><span class="std std-ref">Software licences</span></a>.</p>
</div>
<p>Let’s get these lexicons and see what they contain.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidytext</span><span class="p">)</span>

<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;afinn&quot;</span><span class="p">)</span>

<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;bing&quot;</span><span class="p">)</span>

<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;nrc&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Each one is a table of words (the unigram) and the sentiment, either as an emotion, positive/negative, or a score.</p>
</section>
<section id="using-the-inner-join-to-get-the-sentiments-from-your-data">
<h3>Using the <cite>inner join</cite> to get the sentiments from your data<a class="headerlink" href="#using-the-inner-join-to-get-the-sentiments-from-your-data" title="Link to this heading">#</a></h3>
<p>We can use the Jane Austen book database as our text. Let’s first see which words are used to convey “joy” in
<em>Emma</em>. We firs tneed to seperate the words into seperate rows in a dataframe, for which we can use
<cite>unnest_tokens()</cite>. When we do this, we can also set up some other columns to help keep track of chapters, etc.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">janeaustenr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span>

<span class="n">tidy_books</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">austen_books</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">book</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># so we have each book as a group</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="w">            </span><span class="c1"># add some new columns</span>
<span class="w">    </span><span class="n">linenumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">row_number</span><span class="p">(),</span><span class="w">  </span><span class="c1"># like a line number</span>
<span class="w">    </span><span class="n">chapter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cumsum</span><span class="p">(</span><span class="nf">str_detect</span><span class="p">(</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="c1"># a chapter</span>
<span class="w">                                </span><span class="nf">regex</span><span class="p">(</span><span class="s">&quot;^chapter [\\divxlc]&quot;</span><span class="p">,</span>
<span class="w">                                      </span><span class="n">ignore_case</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># now we&#39;ve done that, ungroup</span>
<span class="w">  </span><span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="c1"># and finally seperate out the words!</span>
</pre></div>
</div>
<p>For <cite>unnest_tokens</cite> we chose the column <cite>word</cite>; this is very helpful - look at the output
from the sentiment lexiconcs before; note they also have a column`word`. This means we can easy
to an <cite>inner_join</cite> on our data and the lexicon to get the sentiment.</p>
<p>Let’s do that, but first we need to filter for the book <em>Emma</em>, then we can do the join and look
at the output:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">nrc_joy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;nrc&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">           </span><span class="nf">filter</span><span class="p">(</span><span class="n">sentiment</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;joy&quot;</span><span class="p">)</span>

<span class="n">tidy_books</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">filter</span><span class="p">(</span><span class="n">book</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Emma&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">inner_join</span><span class="p">(</span><span class="n">nrc_joy</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>You should see the output of the most “joyfull” words in <em>Emma</em>, listed in number of
occurances order. My output gave “good”, “friend”, “hope” as the top three.</p>
<p>We can use the same idea, but analyse the text in “blocks” to see how sentiment
changes throughout the book. It’s a matter of keep track with an index. Here, we’ll use 80
lines of text to form a section. This will depend what text you are analysing.</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span>

<span class="n">jane_austen_sentiment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tidy_books</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;bing&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">count</span><span class="p">(</span><span class="n">book</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linenumber</span><span class="w"> </span><span class="o">%/%</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="n">sentiment</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sentiment</span><span class="p">,</span><span class="w"> </span><span class="n">values_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">values_fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sentiment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">negative</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we’ve done the <cite>inner_join</cite> with the <cite>bing</cite> database and then counted that over
80 lines of text (%/% does integer division). The <cite>pivot_wider</cite> pulls the negative and positive sentiments
into separate columns (the <cite>n</cite> is introduced from the <cite>count</cite>), then finally, the <cite>mutate</cite> creates a
total score. You’ll get a warning about “many-to-many” relationships. This is because of the multiple
matches to words (i.e. words occur multiple times in <em>Emma</em>). Have a look at the <cite>jane_austen_sentiment</cite>
dataframe. Also look at the original <cite>tidy_books</cite> frame. Note that columns <cite>linenumber</cite> and <cite>chapter</cite> have been
dropped during the processing. We can quickly plot these data:</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">jane_austen_sentiment</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">sentiment</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">book</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_col</span><span class="p">(</span><span class="n">show.legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">book</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;free_x&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="A graphs of overall sentiment for each of Austen's novels." src="_images/jane_austen_sentiment.png" />
<div class="admonition-practical-exercise admonition">
<p class="admonition-title">Practical exercise</p>
<p><strong>Use the NRC and AFINN databases</strong></p>
<p>Repeat the analysis of all Jane Austen’s book, but using the AFFIN and NRC
lexicon databases. Remember for AFINN, it’s a score. Remember for NRC there
are positive and negative labels (not just “joy”, etc).</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">jane_austen_sentiment_afinn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tidy_books</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;afinn&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linenumber</span><span class="w"> </span><span class="o">%/%</span><span class="w"> </span><span class="m">80</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">summarise</span><span class="p">(</span><span class="n">sentiment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
</pre></div>
</div>
<p>After <cite>inner_join</cite> with the database, we need to <cite>group_by</cite> the linenumbers
to create the index; we can then summarise by summing the <cite>value</cite> from <cite>afinn</cite>
over the index (i.e. every 80 lines).</p>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">jane_austen_sentiment_nrc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tidy_books</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&quot;nrc&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">               </span><span class="nf">filter</span><span class="p">(</span><span class="n">sentiment</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;positive&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;negative&quot;</span><span class="p">))</span>
<span class="w">              </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">count</span><span class="p">(</span><span class="n">book</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linenumber</span><span class="w"> </span><span class="o">%/%</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="n">sentiment</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sentiment</span><span class="p">,</span><span class="w"> </span><span class="n">values_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">values_fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sentiment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">negative</span><span class="p">)</span>
</pre></div>
</div>
<p>Similar to the <cite>bing</cite> data, you do an <cite>inner_join</cite>, but here, we <cite>filter</cite> the
<cite>nrc</cite> data to only include <cite>positive</cite> and <cite>negative</cite> sentiments (not <cite>joy</cite>, <cite>anger</cite>, etc).
The rest of the functions are then identical to the <cite>bing</cite> example.</p>
</div>
</section>
</section>
<section id="tidal-analysis-in-python">
<h2>Tidal analysis in Python<a class="headerlink" href="#tidal-analysis-in-python" title="Link to this heading">#</a></h2>
<p>Tides are a fundamental part of a number of coastal processes. As sea levels rise, tides will change,
and hence our flood risk, coastal geomorphology and ecological systems will also change as a consequence.</p>
<p>You can run the code below sequentially in Spyder/ipython or create a Jupyter notebook.
Alternatively, save as a script and run from the command line.</p>
<p>Some modules you will need to install are <em>uptide</em> and <em>wget</em></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>uptide
pip<span class="w"> </span>install<span class="w"> </span>wget
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import the modules we need</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">wget</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">uptide</span>
<span class="kn">import</span> <span class="nn">pytz</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
<p>Now we have out environment set up. We can create a couple of “helper” functions to make life easier later!</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_and_process_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">tide_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">tide_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">tide_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">month</span><span class="o">=</span><span class="n">tide_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">day</span><span class="o">=</span><span class="n">tide_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">hour</span><span class="o">=</span><span class="n">tide_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
    <span class="c1"># col 0 is year, col 1 is month, col2 is day, col3 hour</span>
    <span class="n">tide_data</span> <span class="o">=</span> <span class="n">tide_data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">tide_data</span> <span class="o">=</span> <span class="n">tide_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Tide&quot;</span><span class="p">})</span>
    <span class="n">tide_data</span> <span class="o">=</span> <span class="n">tide_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
    <span class="n">tide_data</span> <span class="o">=</span> <span class="n">tide_data</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">tide_data</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">300</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tide_data</span>

<span class="k">def</span> <span class="nf">extract_single_year_remove_mean</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">year_string_start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;0101&quot;</span>
    <span class="n">year_string_end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;1231&quot;</span>
    <span class="n">year_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">year_string_start</span><span class="p">:</span><span class="n">year_string_end</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]]</span>
    <span class="c1"># remove mean to oscillate around zero</span>
    <span class="n">mmm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">year_data</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">])</span>
    <span class="n">year_data</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">mmm</span>

    <span class="k">return</span> <span class="n">year_data</span>
</pre></div>
</div>
<p>We are going to use data from the long term tidal record dataset held by the School of
Ocean and Earth Science and Technology, University of Hawaii. Some of their tidal records
go back over 100 years. We’re going to download data for three locations in Australia:
Freemantle, WA; Booby Island, QLD; and Fort Denison, NSW.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">FortDenison_url</span> <span class="o">=</span> <span class="s2">&quot;https://uhslc.soest.hawaii.edu/data/csv/fast/hourly/h333.csv&quot;</span>
<span class="n">BoobyIsland_url</span> <span class="o">=</span> <span class="s2">&quot;https://uhslc.soest.hawaii.edu/data/csv/fast/hourly/h336.csv&quot;</span>
<span class="n">Freemantle_url</span> <span class="o">=</span> <span class="s2">&quot;https://uhslc.soest.hawaii.edu/data/csv/fast/hourly/h175.csv&quot;</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">FortDenison_url</span><span class="p">,</span> <span class="n">BoobyIsland_url</span><span class="p">,</span> <span class="n">Freemantle_url</span><span class="p">]</span>

<span class="c1"># fetch our data and store</span>
<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="c1"># get the full path to the file</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="c1"># if exists, remove it directly</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">wget</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We now have three csv files which should be stored in your current directory (whever you are
running this code from ).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># load and store as a pandas dataframe</span>
<span class="n">Fort_Denison</span> <span class="o">=</span> <span class="n">read_and_process_data</span><span class="p">(</span><span class="s2">&quot;h333.csv&quot;</span><span class="p">)</span>
<span class="n">Booby_Island</span> <span class="o">=</span> <span class="n">read_and_process_data</span><span class="p">(</span><span class="s2">&quot;h336.csv&quot;</span><span class="p">)</span>
<span class="n">Freemantle</span> <span class="o">=</span> <span class="n">read_and_process_data</span><span class="p">(</span><span class="s2">&quot;h175.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s plot these, choosing an arbitrary year to plot (rather than the whole dataset!)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s plot 1 years&#39; worth of tidal data</span>
<span class="n">fig_summary</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig_summary</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">fd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fort_Denison</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fort Denison&quot;</span><span class="p">)</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Booby_Island</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Booby_Island&quot;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Freemantle</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Freemantle&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water height (mm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)])</span>
<span class="n">fig_summary</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The plot, though busy, already shows some interesting features. Booby Island has the highest tidal
range and shows a clear annual signal. Freemantle has the smallest tidal range and seems fairly constant.</p>
<p>Tide gauges often record the water level so can pick up storms and are affected by even small winds
blowing onshore for example. This means the data you see might not be “just tides”, but also some
aspect of weather, depending on how the data are processed. In addition, for long term records,
the tide gauges will also record sea level rise. All heights are measured above a datum so you
also have to be careful comparing raw data from one tide gauge to another.</p>
<p>Let’s now look at one month in detail:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig_june</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig_june</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">fd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Fort_Denison</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fort Denison&quot;</span><span class="p">)</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Booby_Island</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Booby_Island&quot;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Freemantle</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Freemantle&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water height (mm)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">fig_june</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>We can now see more of the tidal signals. You may notice Freemantle shows fewer wiggles
than the other two locations; this is because it is a diurnal tide: one tide per day.
Fort Denison has a clear two tides per day; semi-diurnal. Booby Island normally has two
tides per days, but some days, those two tides effectively blend into one (see around the
17th June). This is a mixed diurnal-semi diurnal system.</p>
<p>All tidal signals are essentially a mix of multiple sine curves. We know what the frequency of
the external forcing is for tides (the rotation of the earth, the movement of the moon around
the earth, etc), which allows us to break up the signal into constituent parts: the tidal
constituents. These are often given labels such as M2, S2, K1, O1, etc. Each one has a
particular frequency as given in the table below.</p>
<table class="table" id="id3">
<caption><span class="caption-text">Tidal periods</span><a class="headerlink" href="#id3" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Decription</p></th>
<th class="head"><p>Darwin symbol</p></th>
<th class="head"><p>Period (h)</p></th>
<th class="head"><p>Speed (°/h)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Principal lunar semidiurnal</p></td>
<td><p>M2</p></td>
<td><p>12.4206012</p></td>
<td><p>28.9841042</p></td>
</tr>
<tr class="row-odd"><td><p>Principal solar semidiurnal</p></td>
<td><p>S2</p></td>
<td><p>12</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td><p>Lunar diurnal</p></td>
<td><p>K1</p></td>
<td><p>23.9344721</p></td>
<td><p>15.0410686</p></td>
</tr>
<tr class="row-odd"><td><p>Lunar diurnal</p></td>
<td><p>O1</p></td>
<td><p>25.8193387</p></td>
<td><p>13.9430356</p></td>
</tr>
<tr class="row-even"><td><p>Lunisolar semidiurnal</p></td>
<td><p>K2</p></td>
<td><p>11.96723606</p></td>
<td><p>30.0821373</p></td>
</tr>
<tr class="row-odd"><td><p>Larger lunar elliptic semidiurnal</p></td>
<td><p>N2</p></td>
<td><p>12.6583475</p></td>
<td><p>28.4397295</p></td>
</tr>
</tbody>
</table>
<p>There are over 400 different contiuents, but 60-ish is considered enough for accurate
tidal predictions, but fewer still can be used for useful tidal predictions. The tidal
signal can then be reconstructed by summing sine curves of the correct frequency and
amplitude (and phase) to recreate and then predict the tides. At each location the amplitude
and phase will be different.</p>
<p>Let’s add up some sine curves to make something like the tide signals above.</p>
<section id="sine-curves">
<h3>Sine Curves<a class="headerlink" href="#sine-curves" title="Link to this heading">#</a></h3>
<p>Sine cuves can be generalised to the formula:</p>
<div class="math notranslate nohighlight">
\[y = Asin(Bx + C) + D\]</div>
<p><span class="math notranslate nohighlight">\(A\)</span> is the amplitude, <span class="math notranslate nohighlight">\(2 pi / B\)</span> is the period, <span class="math notranslate nohighlight">\(C\)</span> is the phase shift and <span class="math notranslate nohighlight">\(D\)</span> is the
vertical shift. We know the period (from the table above) for each constiuent and <span class="math notranslate nohighlight">\(D\)</span> is not releant here,
so we have two parameters to find: <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">A_m2</span> <span class="o">=</span> <span class="mf">0.53</span>
<span class="n">B_m2</span> <span class="o">=</span> <span class="mf">12.4206012</span> <span class="c1"># hours</span>
<span class="n">C_m2</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="o">*</span><span class="mi">14</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># 14 days in hours</span>
<span class="n">sin_curve</span> <span class="o">=</span> <span class="n">A_m2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">B_m2</span><span class="o">*</span><span class="n">times</span> <span class="o">+</span> <span class="n">C_m2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">sin_curve</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Hours&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Water height (m)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>That’s the M2 curve; let’s now add S2:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">A_s2</span> <span class="o">=</span> <span class="mf">0.23</span>
<span class="n">B_s2</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">C_s2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>

<span class="n">sin_curve</span> <span class="o">=</span> <span class="n">A_m2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">B_m2</span><span class="o">*</span><span class="n">times</span> <span class="o">+</span> <span class="n">C_m2</span><span class="p">)</span> <span class="o">+</span> \
            <span class="n">A_s2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">B_s2</span><span class="o">*</span><span class="n">times</span> <span class="o">+</span> <span class="n">C_s2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">sin_curve</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Hours&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Water height (m)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The above shows what in effect is spring and neap tide using just two components, with different
amplitudes and phases (and frequencies/periods).</p>
<p>We can extract constituents from a tidal signal like those plotted above using least squares
regression analysis to work out what the tidal constiuents are. Let’s do that now to pull
out the common consituents from our tidal data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s first pull out a single year&#39;s worth of data</span>
<span class="c1"># and remove the mean value so the tides oscillate across zero</span>
<span class="n">FD_2008</span> <span class="o">=</span> <span class="n">extract_single_year_remove_mean</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="n">Fort_Denison</span><span class="p">)</span>
<span class="n">BI_2008</span> <span class="o">=</span> <span class="n">extract_single_year_remove_mean</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="n">Booby_Island</span><span class="p">)</span>
<span class="n">F_2008</span> <span class="o">=</span> <span class="n">extract_single_year_remove_mean</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="n">Freemantle</span><span class="p">)</span>

<span class="c1"># We can use the module uptide to work out the tidal constiuents</span>
<span class="c1"># More on uptide: https://github.com/stephankramer/uptide</span>
<span class="kn">import</span> <span class="nn">uptide</span>

<span class="c1"># we create a Tides object with a list of the consituents we want.</span>
<span class="n">tide</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">Tides</span><span class="p">([</span><span class="s1">&#39;M2&#39;</span><span class="p">])</span>

<span class="c1"># We then set out start time. All data must then be in second since this time</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># so let&#39;s swap our dates for seconds since midnight 1/1/2008.</span>
<span class="c1"># Note the 1e9 (the int64 seconds epoch in numpy is multiplied by this for some reason)</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">FD_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>

<span class="c1"># We then send the elevation data (our tides) and time in seconds to uptide</span>
<span class="c1"># and do the harmonic analysis</span>
<span class="n">amp</span><span class="p">,</span><span class="n">pha</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">FD_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>

<span class="c1"># uptide returns the amplitudes as a list (in the order of the constiuents listed above) and the phases (in radians)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">pha</span><span class="p">)</span>
</pre></div>
</div>
<p>The above numbers are the tidal amplitude for the M2 constiuent at Fort Denison (0.5013 m) and the phase (5.366 radians).
We can look up what the actual numbers are for Fort Denison (exercise for the reader!).
However, we’ve forgotten something: <em>timezones</em>!</p>
<p>We also need to account for the timezone of the data. The phase is measured relative to
UTC/GMT. We therefore need to tell the analysis the time data is in the Sydney timezone.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s2">&quot;Australia/Sydney&quot;</span><span class="p">)</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">FD_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>

<span class="n">amp</span><span class="p">,</span><span class="n">pha</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">FD_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span><span class="n">pha</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-practical-exercise admonition">
<p class="admonition-title">Practical exercise</p>
<p><strong>Extract the M2 component from Booby Island and Freemantle</strong></p>
<blockquote>
<div><p>Write code to extract the M2 amplitude and phase for the Freementle
and Booby Island tidal data. Hint; remember the timezones!</p>
</div></blockquote>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s2">&quot;Australia/Lindeman&quot;</span><span class="p">)</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">BI_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>

<span class="n">amp</span><span class="p">,</span><span class="n">pha</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">BI_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span><span class="n">pha</span><span class="p">)</span>

<span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s2">&quot;Australia/Perth&quot;</span><span class="p">)</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>

<span class="n">amp</span><span class="p">,</span><span class="n">pha</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">F_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span><span class="n">pha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>What happens when we want multiple constiuents? The first thing we need to consider is how long our
data record is. Consituents that have a period/frequency that is close together need a longer
dataset to be able to seperate them out. We can use something called the Rayleigh Critereon
to work out how long a record we need.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">constituents</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;M4&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uptide</span><span class="o">.</span><span class="n">select_constituents</span><span class="p">(</span><span class="n">constituents</span><span class="p">,</span><span class="mi">15</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">))</span> <span class="c1"># This is 15 days in seconds</span>
</pre></div>
</div>
<p>What we get back is that we can’t resolve the N2, K2 and Q1 from the list with 15 days worth of data.
What if we had 30 days?</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">constituents</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;M4&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">uptide</span><span class="o">.</span><span class="n">select_constituents</span><span class="p">(</span><span class="n">constituents</span><span class="p">,</span><span class="mi">30</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="p">))</span>
</pre></div>
</div>
<p>Nope! K2 is still not able to be resolved from 30 days worth of data. How many days would we need?</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tide</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">Tides</span><span class="p">(</span><span class="n">constituents</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tide</span><span class="o">.</span><span class="n">get_minimum_Rayleigh_period</span><span class="p">()</span><span class="o">/</span><span class="mf">86400.</span><span class="p">)</span>
</pre></div>
</div>
<p>82.6 days worth of data to be able to work out the constituents listed above. So with our year of data we should be fine!</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s2">&quot;Australia/Sydney&quot;</span><span class="p">)</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">FD_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>

<span class="n">amp</span><span class="p">,</span><span class="n">pha</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">FD_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">pha</span><span class="p">)</span>
</pre></div>
</div>
<p>At Fort Denison our amplitudes and phases are:</p>
<blockquote>
<div><ul class="simple">
<li><p>M2: 0.503 m and 4.182 radians</p></li>
<li><p>S2: 0.125 m and 4.599 radians</p></li>
<li><p>N2: 0.115 m and 3.93 radians</p></li>
<li><p>K2: 0.036 m and 4.27 radians</p></li>
<li><p>O1: 0.097 m and 1.42 radians</p></li>
<li><p>P1: 0.043 m and 1.99 radians</p></li>
<li><p>Q1: 0.020 m and 1.016 radians</p></li>
<li><p>M4: 0.003 m and 2.09 radians</p></li>
</ul>
</div></blockquote>
<p>We could plot those using sine curves. However, <cite>uptide</cite> also has functionality to
give us a total tidal signal from the amplitudes and phases.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">365</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="mi">1800</span><span class="p">)</span> <span class="c1"># 1 year in 1800 second intervals</span>
<span class="n">eta</span> <span class="o">=</span> <span class="n">tide</span><span class="o">.</span><span class="n">from_amplitude_phase</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">pha</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">fig_summary</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig_summary</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="c1"># note we use seconds since as t (for the theoretical plot) is also in seconds</span>
<span class="n">fd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seconds_since</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="n">FD_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fort Denison&quot;</span><span class="p">)</span>
<span class="n">theoretical</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Theoretical&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Days&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water height (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="c1"># uncomment line below and rerun to see a zoom in</span>
<span class="c1">#ax.set_xlim([14, 44]) # only plot 30 days worth</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig_summary</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-practical-exercise admonition">
<p class="admonition-title">Practical exercise</p>
<p><strong>Extract all components and plot for Booby Island and Freemantle</strong></p>
<p>Do the same for Booby Island and Freemantle.</p>
</div>
<div class="toggle admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s2">&quot;Australia/Lindeman&quot;</span><span class="p">)</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">BI_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
<span class="n">amp_bi</span><span class="p">,</span><span class="n">pha_bi</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">BI_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>
<span class="n">tz</span> <span class="o">=</span> <span class="n">pytz</span><span class="o">.</span><span class="n">timezone</span><span class="p">(</span><span class="s2">&quot;Australia/Perth&quot;</span><span class="p">)</span>
<span class="n">tide</span><span class="o">.</span><span class="n">set_initial_time</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">seconds_since</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_2008</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mf">1e9</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span>
<span class="n">amp_f</span><span class="p">,</span><span class="n">pha_f</span> <span class="o">=</span> <span class="n">uptide</span><span class="o">.</span><span class="n">harmonic_analysis</span><span class="p">(</span><span class="n">tide</span><span class="p">,</span> <span class="n">F_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seconds_since</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">365</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span><span class="p">,</span> <span class="mi">1800</span><span class="p">)</span> <span class="c1"># 1 year in 1800 second intervals</span>

<span class="n">eta_bi</span> <span class="o">=</span> <span class="n">tide</span><span class="o">.</span><span class="n">from_amplitude_phase</span><span class="p">(</span><span class="n">amp_bi</span><span class="p">,</span> <span class="n">pha_bi</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">eta_f</span> <span class="o">=</span> <span class="n">tide</span><span class="o">.</span><span class="n">from_amplitude_phase</span><span class="p">(</span><span class="n">amp_f</span><span class="p">,</span> <span class="n">pha_f</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

<span class="n">fig_summary</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">fig_summary</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="c1"># note we use seconds since as t (for the theoretical plot) is also in seconds</span>
<span class="n">bi</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seconds_since</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="n">BI_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Bobby Island&quot;</span><span class="p">)</span>
<span class="n">theoretical_bi</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="n">eta_bi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dasjed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BI Theoretical&quot;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seconds_since</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="n">F_2008</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Freemantle&quot;</span><span class="p">)</span>
<span class="n">theoretical_f</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="n">eta_f</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;F Theoretical&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Days&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Water height (m)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="c1"># uncomment line below and rerun to see a zoom in</span>
<span class="c1">#ax.set_xlim([14, 44]) # only plot 30 days worth</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig_summary</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="gis">
<h2>GIS<a class="headerlink" href="#gis" title="Link to this heading">#</a></h2>
<p>This is a brief introduction to geospatial data which applied to both Python
and R. Geospatial data is information that also has a geographical component.
Example include house proces, coupled to locations; roads and road types or hazard
assessment.</p>
<p>There are three things we need to learn about first:</p>
<blockquote>
<div><ul class="simple">
<li><p>vector data</p></li>
<li><p>raster data</p></li>
<li><p>projection spaces or coordinate spaces</p></li>
</ul>
</div></blockquote>
<section id="vector-data">
<h3>Vector data<a class="headerlink" href="#vector-data" title="Link to this heading">#</a></h3>
<p>Vector data represent geometries via mathematicla objects. You can zoom
into a vector infinitely at it will remain infintely small! There are
three types of vector data:</p>
<blockquote>
<div><ul class="simple">
<li><p>points</p></li>
<li><p>lines</p></li>
<li><p>polygons</p></li>
</ul>
</div></blockquote>
<p>Vectors are most commonly stored as shapefiles: <code class="docutils literal notranslate"><span class="pre">*.shp</span></code> files. We call then shapefiles
put they actually consist of a number of files. So a file called <code class="docutils literal notranslate"><span class="pre">landslides.shp</span></code> also
will have <code class="docutils literal notranslate"><span class="pre">landslides.prj</span></code>, <code class="docutils literal notranslate"><span class="pre">landslides.dbf</span></code> and <code class="docutils literal notranslate"><span class="pre">landslides.shx</span></code> and a few more beside.
All files are required to fully define the shapefile.</p>
<p>Shapefiles often contain data alongside the vector representation. So for example, the shape
of buildings might be contained in the shapefile, but the polygons with the outline of the building
footprint might also contains the address, the price, the date built, etc.</p>
</section>
<section id="raster-data">
<h3>Raster data<a class="headerlink" href="#raster-data" title="Link to this heading">#</a></h3>
<p>Raster data are a grid of pixels of a resolution. Each pixel has a value, such as height
temperature, land use category, etc. The data are stored in <em>bands</em>, so a raster can contain
multiple datasets within the same structure and file. It’s common for colour
images, such as satellite images, to be stored in a R(ed), G(reeen), and B(lue) bands.</p>
<p>The image below shows the difference between how data is stored in both raster
and vector formats; either can be used, but raster data have a “resolution” issue where
the size of the grid alters the accuracy of the data. However, raster data can store a
lot of data very efficiently, e.g. land hieght data where you need continuous measurements.</p>
<figure class="align-default" id="id4">
<img alt="Difference between raster and vector images." src="_images/raster_vector_gis.png" />
<figcaption>
<p><span class="caption-text">Raster vs Vector for a land-use type dataset. From <a class="reference external" href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a> by <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Joey-das-WBF">Johannes Rössel</a> (CC-BY-SA licence)</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="coredinate-references-system-crs">
<h3>Coredinate References System (CRS)<a class="headerlink" href="#coredinate-references-system-crs" title="Link to this heading">#</a></h3>
<p>GIS is a 2D system. But the Earth is 3D; almost a sphere in fact. To display the
3D surface to a 2D screen you need to project into a 2D space; the CRS. Any
CRS required trade offs. You can preserve area or shape or distance, but not all three!
Compare the two projections of the Earth below; the Mollweide preserves areas, so the size of Greenland
to Africa is shown to scale, but you could not navigate using this map; your bearings
would be very wrong! The Mercator projection preserves areas; excellent for navigation, but
not so good for comparing areas. Greenland (2.1 million km<sup>2</sup>) is not bigger than the whole of Africa
(30.1 million km<sup>2</sup>)!</p>
<p>In R and Python if you are doing operations on geospatial data they <strong>must</strong> be in the
same project space. Your operation may work, but you won’t get the result you want!</p>
<p>Common projection spaces are “mercator” and “Universal Tranverse Mercator (UTM)”. For
“regional” studies UTM is best. It’s in metres (not degrees!) and covers a reasonably
large area with little deformation.</p>
<figure class="align-default" id="id5">
<img alt="A global Mollweide projection which preserves area." src="_images/Mollweide_projection_SW.jpg" />
<figcaption>
<p><span class="caption-text">Mollweide projection of the Earth, preserving areas. From <a class="reference external" href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a> by <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Strebe">Daniel R. Strebe</a> (CC-BY-SA licence)</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id6">
<img alt="A global Mercator projection which preserves angles." src="_images/Mercator_projection_Square.JPG" />
<figcaption>
<p><span class="caption-text">Mercator projection of the Earth, preserving angles. From <a class="reference external" href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a> by <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Strebe">Daniel R. Strebe</a> (CC-BY-SA licence)</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="gis-r">
<h2>GIS - R<a class="headerlink" href="#gis-r" title="Link to this heading">#</a></h2>
</section>
<section id="gis-python">
<h2>GIS - Python<a class="headerlink" href="#gis-python" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Software_development.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Software development</p>
      </div>
    </a>
    <a class="right-next"
       href="genindex.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Index</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ggplot2-tutorial">ggplot2 tutorial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataset">The dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-basics">Plotting basics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#themes">Themes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#axes">Axes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#axes-limits-and-scales">Axes limits and scales</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-legends">Plot legends</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colours">Colours</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-plots">Multiple plots</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#facets">Facets</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-plot">Saving the plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pyplot-tutorial">Pyplot tutorial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-pyplot">Introduction to pyplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formatting-the-style-of-your-plot">Formatting the style of your plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-with-keyword-strings">Plotting with keyword strings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-with-categorical-variables">Plotting with categorical variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#controlling-line-properties">Controlling line properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-multiple-figures-and-axes">Working with multiple figures and axes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-text">Working with text</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-mathematical-expressions-in-text">Using mathematical expressions in text</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#annotating-text">Annotating text</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logarithmic-and-other-nonlinear-axes">Logarithmic and other nonlinear axes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sentiment-analysis">Sentiment Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pipeline-in-r">The pipeline in R</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-inner-join-to-get-the-sentiments-from-your-data">Using the <cite>inner join</cite> to get the sentiments from your data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tidal-analysis-in-python">Tidal analysis in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sine-curves">Sine Curves</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis">GIS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-data">Vector data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raster-data">Raster data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coredinate-references-system-crs">Coredinate References System (CRS)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-r">GIS - R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gis-python">GIS - Python</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jon Hill
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, Jon Hill.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>